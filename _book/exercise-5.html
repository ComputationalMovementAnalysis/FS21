<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>GEO880: Patterns and Trends in Environmental Data</title>
  <meta name="description" content="GEO880: Patterns and Trends in Environmental Data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="GEO880: Patterns and Trends in Environmental Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="GEO880: Patterns and Trends in Environmental Data" />
  
  
  

<meta name="author" content="Patrick Laube and Nils Ratnaweera">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exercise-4.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.0.27/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-1.1.0/leaflet-providers-plugin.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction Chapter</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#leaning-outcomes"><i class="fa fa-check"></i>Leaning outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#preperation"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#tasks-and-inputs"><i class="fa fa-check"></i>Tasks and inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-1-initialize-project"><i class="fa fa-check"></i>Task 1: Initialize project</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2-import-data"><i class="fa fa-check"></i>Task 2: Import data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3-explore-data"><i class="fa fa-check"></i>Task 3: Explore Data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-handling-spatial-data"><i class="fa fa-check"></i>Input: Handling spatial data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4-project-data-from-wgs84"><i class="fa fa-check"></i>Task 4: Project data from WGS84</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-calculate-convex-hull"><i class="fa fa-check"></i>Input: Calculate Convex Hull</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5-ploting-spatial-objects"><i class="fa fa-check"></i>Task 5: Ploting spatial objects</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6-adding-a-background-map"><i class="fa fa-check"></i>Task 6: Adding a background map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#solutions"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task1"><i class="fa fa-check"></i>Task1</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-1"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6"><i class="fa fa-check"></i>Task 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#preperation-1"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#demo-tidyverse"><i class="fa fa-check"></i>Demo Tidyverse</a><ul>
<li><a href="exercise-2.html#difftime"><code>difftime</code></a></li>
<li><a href="exercise-2.html#lead-lag"><code>lead()</code> / <code>lag()</code></a></li>
<li><a href="exercise-2.html#mutate"><code>mutate()</code></a></li>
<li><a href="exercise-2.html#group_by"><code>group_by()</code></a></li>
<li><a href="exercise-2.html#summarise"><code>summarise()</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#bring-it-all-together"><i class="fa fa-check"></i>Bring it all together…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#tasks-and-inputs-1"><i class="fa fa-check"></i>Tasks and Inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-1-getting-an-overview"><i class="fa fa-check"></i>Task 1: Getting an overview</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#input-geometry-as-columns"><i class="fa fa-check"></i>Input: Geometry as columns</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-2-deriving-movement-parameters-i-euclidean-distance-and-speed"><i class="fa fa-check"></i>Task 2: Deriving movement parameters I: Euclidean Distance and Speed</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-3-cross-scale-movement-analysis"><i class="fa fa-check"></i>Task 3: Cross-scale movement analysis</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-4-deriving-movement-parameters-ii-rolling-window-functions"><i class="fa fa-check"></i>Task 4: Deriving movement parameters II: Rolling window functions</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-5-optional-calculate-turning-angles"><i class="fa fa-check"></i>Task 5 (optional): Calculate turning angles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#solutions-1"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#preperation-2"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#demo-tidyverse-1"><i class="fa fa-check"></i>Demo Tidyverse</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-1"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#input-2"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-2-1"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-3-1"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-4-1"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-5-1"><i class="fa fa-check"></i>Task 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i>Exercise 3</a><ul>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#learning-outcomes-1"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#preperation-3"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#tasks-and-inputs-2"><i class="fa fa-check"></i>Tasks and Inputs</a><ul>
<li><a href="exercise-3.html#input-segmentation-a-la-laube2011">Input: Segmentation à la <span class="citation">Laube and Purves (<a href="#ref-laube2011">2011</a>)</span></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-1-segmentation"><i class="fa fa-check"></i>Task 1: Segmentation</a></li>
<li><a href="exercise-3.html#task-2-specify-and-apply-threshold-d">Task 2: Specify and apply threshold <em>d</em></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-3-visualize-segmented-trajectories"><i class="fa fa-check"></i>Task 3: Visualize segmented trajectories</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-4-segment-based-analysis"><i class="fa fa-check"></i>Task 4: Segment-based analysis</a></li>
<li><a href="exercise-3.html#task-5-optional-plotting-with-leaflet">Task 5 (Optional): Plotting with <code>leaflet</code></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-6-similarity-measures"><i class="fa fa-check"></i>Task 6: Similarity measures</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-7-calculate-similarity"><i class="fa fa-check"></i>Task 7: Calculate similarity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#solutions-2"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#preperation-4"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#input-3"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task1-1"><i class="fa fa-check"></i>Task1</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-2-2"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-3-2"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-4-2"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-5-2"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-6-1"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-7"><i class="fa fa-check"></i>Task 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i>Exercise 4</a><ul>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#learning-outcomes-2"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#preperation-5"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#tasks"><i class="fa fa-check"></i>Tasks</a><ul>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-1-filter-and-visualize-trajectories"><i class="fa fa-check"></i>Task 1: Filter and visualize trajectories</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#input-creating-functions"><i class="fa fa-check"></i>Input: Creating functions</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-2-optional-create-custom-function"><i class="fa fa-check"></i>Task 2 (Optional): Create custom function</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-3-resample-data"><i class="fa fa-check"></i>Task 3: Resample data</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-4-seperate-into-multiple-data.frames"><i class="fa fa-check"></i>Task 4: Seperate into multiple data.frames</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-5-join-data-by-time"><i class="fa fa-check"></i>Task 5: Join data by time</a></li>
<li><a href="exercise-4.html#task-6-visualize-data-with-ggplot">Task 6: Visualize data with <code>ggplot</code></a></li>
<li><a href="exercise-4.html#task-7-optional-visualize-data-with-leaflet">Task 7 (Optional): Visualize data with <code>leaflet</code></a></li>
<li><a href="exercise-4.html#task-8-optional-visualize-data-as-timecube-with-plotly">Task 8 (optional): Visualize data as timecube with <code>plotly</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#solutions-3"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#preperation-6"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-1-1"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#input-4"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-2-3"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-3-3"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-4-3"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-5-3"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-6-2"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-7-optional"><i class="fa fa-check"></i>Task 7 (Optional)</a></li>
<li class="chapter" data-level="" data-path="exercise-4.html"><a href="exercise-4.html#task-8"><i class="fa fa-check"></i>Task 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i>Exercise 5</a><ul>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#learning-outcomes-3"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#preperation-7"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#tasks-1"><i class="fa fa-check"></i>Tasks</a><ul>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#tasks-1-import-and-visualize-spatial-data"><i class="fa fa-check"></i>Tasks 1: Import and visualize spatial data</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-2-annotate-trajectories-from-vector-data"><i class="fa fa-check"></i>Task 2: Annotate Trajectories from vector data</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-3-explore-annotated-trajectories"><i class="fa fa-check"></i>Task 3: Explore annotated trajectories</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-4-annotate-trajectories-from-raster-data"><i class="fa fa-check"></i>Task 4: Annotate Trajectories from raster data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#solutions-4"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#preperation-8"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-1-2"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-2-4"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-5.html"><a href="exercise-5.html#task-4-4"><i class="fa fa-check"></i>Task 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO880: Patterns and Trends in Environmental Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-5" class="section level1">
<h1>Exercise 5</h1>
<div id="learning-outcomes-3" class="section level2">
<h2>Learning Outcomes</h2>
<ul>
<li>You are able to process spatial data (vector and raster) within R, including creating simple maps within R</li>
<li>You know basic operations for semantically annotating your trajectories with geographic context.</li>
</ul>
</div>
<div id="preperation-7" class="section level2">
<h2>Preperation</h2>
<p>Open your R Project from last week. Either run your own script from last week or the following lines to transform the data into the form we need for today’s exercise. <em>Important: Reinstall the package <code>CMAtools</code> since we have made a few updates.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_git</span>(<span class="st">&quot;https://github.engineering.zhaw.ch/PatternsTrendsEnvironmentalData/CMAtools.git&quot;</span>) <span class="co"># Reinstall this package, since we have a few updates</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(CMAtools)
<span class="kw">library</span>(sf)
<span class="kw">library</span>(ggspatial)
<span class="kw">library</span>(raster)

<span class="co"># Import as tibble</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/wildschwein_BE.csv&quot;</span>,<span class="st">&quot;,&quot;</span>)


<span class="co"># Convert to sf-object</span>
wildschwein_BE =<span class="st"> </span><span class="kw">st_as_sf</span>(wildschwein_BE, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Long&quot;</span>, <span class="st">&quot;Lat&quot;</span>), <span class="dt">crs =</span> <span class="dv">4326</span>,<span class="dt">remove =</span> <span class="ot">FALSE</span>)

<span class="co"># transform to CH1903 LV95</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wildschwein_BE, <span class="dv">2056</span>)

<span class="co"># Add geometry as E/N integer Columns</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(wildschwein_BE) %&gt;%
<span class="st">  </span><span class="kw">cbind</span>(wildschwein_BE,.) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">E =</span> X) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">N =</span> Y)

<span class="co"># Compute timelag, steplength and speed</span>
wildschwein_BE &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">timelag =</span> <span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">lead</span>(DatetimeUTC),DatetimeUTC,<span class="dt">units =</span> <span class="st">&quot;secs&quot;</span>)),
    <span class="dt">steplength =</span> <span class="kw">euclid</span>(<span class="kw">lead</span>(E, <span class="dv">1</span>),<span class="kw">lead</span>(N, <span class="dv">1</span>),E,N),
    <span class="dt">speed =</span> steplength/timelag
  )</code></pre></div>
</div>
<div id="tasks-1" class="section level2">
<h2>Tasks</h2>
<div id="tasks-1-import-and-visualize-spatial-data" class="section level3">
<h3>Tasks 1: Import and visualize spatial data</h3>
<ul>
<li>Import the vector dataset <code>Feldaufnahmen_Fanel_2016.shp</code> from moodle with <code>read_sf()</code> and save it to the variable <code>fanel2016</code>. The file .shp stands for Shapefile, which is a simple format for spatial vector data (points, line, or polygons). This shapefile contains vector data about cultivated crops in the study area.</li>
<li>Transform the coordinates to <code>CH1903+ LV95</code>.</li>
<li>Filter the dataset <code>wildschwein_BE</code> to the period 01.04.2016 to 30.09.2016 and store the data in a new variable (<code>wildschwein_BE_2016</code>).</li>
<li>Create a minimum convex polygon for each individual in <code>wildschwein_BE_2016</code> and store it in a new variable (<code>mcp2016</code>)</li>
<li>Import the raster data file <code>pk100_BE_2056.tif</code>. PK stands for Pixel-Karte.</li>
<li>Create a map with the layers <code>pk100_BE_2056.tif</code>, <code>fanel2016</code> and <code>mcp2016</code>.</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
<div id="task-2-annotate-trajectories-from-vector-data" class="section level3">
<h3>Task 2: Annotate Trajectories from vector data</h3>
<p>Now we would like to know what crop was most visited by our wild boar, and at what time. To this end, use <code>st_join()</code> to attach the attributes from <code>fanel2016</code> to your trajectory data <code>wildschwein_BE_2016</code> (semantic annotation). Visualize the number of sample points in each category of <code>Frucht</code> over the course of the filtered time period.</p>
<div class="figure"><span id="fig:unnamed-chunk-181"></span>
<img src="_main_files/figure-html/unnamed-chunk-181-1.png" alt="The number of samples per category *per week* from April to September 2014." width="672" />
<p class="caption">
Figure 14: The number of samples per category <em>per week</em> from April to September 2014.
</p>
</div>
</div>
<div id="task-3-explore-annotated-trajectories" class="section level3">
<h3>Task 3: Explore annotated trajectories</h3>
<p>Think of other ways you could visually explore the spatio-temporal patterns of wild boar in relation to the crops.</p>
<p>Ideas:</p>
<ul>
<li>For example, in the visualisation above, we did not account for the different availability of the different crops. Potatoes (“Kartoffeln”) are seemingly not visited at all, while Rapeseed (“Raps”) has high visitation from Mai to June. Maybe this is due to the fact that there are mostly Rapeseed fields and basically no Potatoe Fields. How could you consider availability in the visulisation?</li>
<li>Expore Circadian rhythm / daily patterns of crop visitations</li>
</ul>
</div>
<div id="task-4-annotate-trajectories-from-raster-data" class="section level3">
<h3>Task 4: Annotate Trajectories from raster data</h3>
<p>In terms of raster data, we have prepared a <a href="https://gisgeography.com/lidar-light-detection-and-ranging/">Normalised Digital Surface Model (nDSM)</a><a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>, which provides information on the height of topological features on the ground. Since our wild boar usually use natural landscapes, the nDSM is a good approximation of vegitation height. This nDSM is available on moodle (<code>nDSM.tif</code>). Import this data with <code>raster()</code>and attach the respective raster values to the point data in your <code>sf</code> object (<code>wildschwein_BE_2016</code>). Explore the dataset similar to the crop data in task 2/3. Explore again spatio-temporal relations!</p>
<div class="figure"><span id="fig:unnamed-chunk-184"></span>
<img src="_main_files/figure-html/unnamed-chunk-184-1.png" alt="An example of a temporal exploration of the data obtained from the nDSM." width="672" />
<p class="caption">
Figure 15: An example of a temporal exploration of the data obtained from the nDSM.
</p>
</div>
</div>
</div>
<div id="solutions-4" class="section level2">
<h2>Solutions</h2>
<div id="preperation-8" class="section level3">
<h3>Preperation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## devtools::install_git(&quot;https://github.engineering.zhaw.ch/PatternsTrendsEnvironmentalData/CMAtools.git&quot;) # Reinstall this package, since we have a few updates
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(CMAtools)
<span class="kw">library</span>(sf)
<span class="kw">library</span>(ggspatial)
<span class="kw">library</span>(raster)

<span class="co"># Import as tibble</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/wildschwein_BE.csv&quot;</span>,<span class="st">&quot;,&quot;</span>)


<span class="co"># Convert to sf-object</span>
wildschwein_BE =<span class="st"> </span><span class="kw">st_as_sf</span>(wildschwein_BE, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Long&quot;</span>, <span class="st">&quot;Lat&quot;</span>), <span class="dt">crs =</span> <span class="dv">4326</span>,<span class="dt">remove =</span> <span class="ot">FALSE</span>)

<span class="co"># transform to CH1903 LV95</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wildschwein_BE, <span class="dv">2056</span>)

<span class="co"># Add geometry as E/N integer Columns</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(wildschwein_BE) %&gt;%
<span class="st">  </span><span class="kw">cbind</span>(wildschwein_BE,.) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">E =</span> X) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">N =</span> Y)

<span class="co"># Compute timelag, steplength and speed</span>
wildschwein_BE &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">timelag =</span> <span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">lead</span>(DatetimeUTC),DatetimeUTC,<span class="dt">units =</span> <span class="st">&quot;secs&quot;</span>)),
    <span class="dt">steplength =</span> <span class="kw">euclid</span>(<span class="kw">lead</span>(E, <span class="dv">1</span>),<span class="kw">lead</span>(N, <span class="dv">1</span>),E,N),
    <span class="dt">speed =</span> steplength/timelag
  )</code></pre></div>
</div>
<div id="task-1-2" class="section level3">
<h3>Task 1</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(lubridate)

fanel2016 &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/Kulturen/Feldaufnahmen_Fanel_2016.shp&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">2056</span>)

pk100_BE &lt;-<span class="st"> </span><span class="kw">brick</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/pk100_BE_2056.tif&quot;</span>)


wildschwein_BE_2016 &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">filter</span>(DatetimeUTC &gt;=<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-01&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(DatetimeUTC &lt;=<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-09-30&quot;</span>))


mcp2016 &lt;-<span class="st"> </span>wildschwein_BE_2016 %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>() %&gt;%
<span class="st">  </span><span class="kw">st_convex_hull</span>()


<span class="kw">ggplot</span>(fanel2016, <span class="kw">aes</span>(<span class="dt">fill =</span> Frucht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">annotation_spraster</span>(pk100_BE) +
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) +
<span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> mcp2016, <span class="kw">aes</span>(<span class="dt">colour =</span> TierID), <span class="dt">inherit.aes =</span> F, <span class="dt">alpha =</span> <span class="fl">0.1</span>,<span class="dt">lwd =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
  </code></pre></div>
</div>
<div id="task-2-4" class="section level3">
<h3>Task 2</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wildschwein_BE_2016 &lt;-<span class="st"> </span>wildschwein_BE_2016 %&gt;%
<span class="st">  </span><span class="kw">st_join</span>(dplyr::<span class="kw">select</span>(fanel2016,Frucht))


frucht_remove &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;Flugplatz&quot;</span>,<span class="st">&quot;Rhabarber&quot;</span>,<span class="st">&quot;Zucchetti&quot;</span>)

wildschwein_BE_2016 %&gt;%
<span class="st">  </span><span class="kw">as.data.frame</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week =</span> <span class="kw">floor_date</span>(DatetimeUTC,<span class="st">&quot;weeks&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(week,Frucht) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!Frucht %in%<span class="st"> </span>frucht_remove) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(Frucht !=<span class="st"> &quot;NA&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(week,n, <span class="dt">group =</span> Frucht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;Number of Samples&quot;</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~Frucht) +
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
</div>
<div id="task-4-4" class="section level3">
<h3>Task 4</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ndsm &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/nDSM.tif&quot;</span>)

wildschwein_BE_2016 &lt;-<span class="st"> </span>wildschwein_BE_2016 %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dod =</span> raster::<span class="kw">extract</span>(ndsm,.))


wildschwein_BE_2016 %&gt;%
<span class="st">  </span><span class="kw">as.data.frame</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">hour =</span> <span class="kw">hour</span>(<span class="kw">round_date</span>(DatetimeUTC,<span class="st">&quot;1 hours&quot;</span>))
    ) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID,hour) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">mean =</span> <span class="kw">mean</span>(dod,<span class="dt">na.rm =</span> T),
    <span class="dt">sd =</span> <span class="kw">sd</span>(dod,<span class="dt">na.rm =</span> T),
    <span class="dt">up =</span> mean+sd,
    <span class="dt">do =</span> mean-sd
    ) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour,<span class="dt">y =</span> mean,<span class="dt">ymin =</span> do, <span class="dt">ymax =</span> up, <span class="dt">colour =</span> TierID,<span class="dt">fill =</span> TierID)) +
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;nDSM&quot;</span>,<span class="dt">title =</span> <span class="st">&quot;nDSM values as an approximation for vegitation hight&quot;</span>,<span class="dt">subtitle =</span> <span class="st">&quot;The line represents the mean nDSM value and the ribbon one standard deviation&quot;</span>) +
<span class="st">  </span><span class="kw">theme_minimal</span>()
    
  </code></pre></div>
<!-- ### Task 5 (Optional): Determine revisited sites -->
<!-- The package `recurse` helps find areas which are re-visited by the same indiviual. This gives us interesting insights into the ecology of our animals.  -->
<!-- ```{r,, echo = F, include = T} -->
<!-- library(recurse) -->
<!-- library(ggforce) -->
<!-- recurs <- wildschwein_BE %>% -->
<!--   filter(TierID == "001A") %>% -->
<!--   dplyr::select(E,N,DatetimeUTC,TierID) %>% -->
<!--   st_set_geometry(NULL) %>% -->
<!--   as.data.frame() %>% -->
<!--   getRecursions(100) -->
<!-- recurStats <- recurs$revisitStats -->
<!-- recurStats <- recurStats %>% -->
<!--   group_by(coordIdx) %>% -->
<!--   summarise( -->
<!--     number_of_visits = max(visitIdx), -->
<!--     x = unique(x), -->
<!--     y = unique(y), -->
<!--     total_time = sum(timeInside), -->
<!--     max_time = max(timeInside), -->
<!--     mean_time = mean(timeInside) -->
<!--   ) -->
<!-- data1 = filter(recurStats, number_of_visits > 30) -->
<!-- wildschwein_BE %>% -->
<!--   ungroup() %>% -->
<!--   filter(TierID == "001A") %>% -->
<!--   ggplot(aes(E,N)) + -->
<!--   geom_point(alpha = 0.4, colour = "grey") + -->
<!--   geom_circle(data = data1, alpha = 0.5, aes(x0 = x,y0 = y,fill = mean_time,r = 100),inherit.aes = F) + -->
<!--   coord_fixed(1) -->
<!-- ``` -->

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>The nDSM was created by calculating the difference between the <a href="https://www.geo.apps.be.ch/de/geodaten/suche-nach-geodaten.html?view=sheet&amp;guid=094ce943-6ad7-4f07-aa9f-d8eb17c5cb38&amp;catalog=geocatalog&amp;type=complete&amp;preview=search_list">digital surface models (DSM)</a> and the <a href="https://www.geo.apps.be.ch/de/geodaten/suche-nach-geodaten.html?view=sheet&amp;guid=490de97b-8932-4ef7-9d13-e89ef41eeb4b&amp;catalog=geocatalog&amp;type=complete&amp;preview=search_list">digital terrain model (DTM)</a> obtained from the <a href="https://www.geo.apps.be.ch/de/geodaten/suche-nach-geodaten.html">geoportal from the canton Bern</a>.<a href="exercise-5.html#fnref7">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
