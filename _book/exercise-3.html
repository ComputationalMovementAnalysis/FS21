<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>GEO880: Patterns and Trends in Environmental Data</title>
  <meta name="description" content="GEO880: Patterns and Trends in Environmental Data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="GEO880: Patterns and Trends in Environmental Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="GEO880: Patterns and Trends in Environmental Data" />
  
  
  

<meta name="author" content="Patrick Laube and Nils Ratnaweera">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exercise-2.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction Chapter</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#leaning-outcomes"><i class="fa fa-check"></i>Leaning outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#preperation"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#tasks-and-inputs"><i class="fa fa-check"></i>Tasks and inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-1-initialize-project"><i class="fa fa-check"></i>Task 1: Initialize project</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2-import-data"><i class="fa fa-check"></i>Task 2: Import data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3-explore-data"><i class="fa fa-check"></i>Task 3: Explore Data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-handling-spatial-data"><i class="fa fa-check"></i>Input: Handling spatial data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4-project-data-from-wgs84"><i class="fa fa-check"></i>Task 4: Project data from WGS84</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-calculate-convex-hull"><i class="fa fa-check"></i>Input: Calculate Convex Hull</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5-ploting-spatial-objects"><i class="fa fa-check"></i>Task 5: Ploting spatial objects</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6-adding-a-background-map"><i class="fa fa-check"></i>Task 6: Adding a background map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#solutions"><i class="fa fa-check"></i>Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task1"><i class="fa fa-check"></i>Task1</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-1"><i class="fa fa-check"></i>Input</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6"><i class="fa fa-check"></i>Task 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#preperation-1"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#demo-tidyverse"><i class="fa fa-check"></i>Demo Tidyverse</a><ul>
<li><a href="exercise-2.html#difftime"><code>difftime</code></a></li>
<li><a href="exercise-2.html#lead-lag"><code>lead()</code> / <code>lag()</code></a></li>
<li><a href="exercise-2.html#mutate"><code>mutate()</code></a></li>
<li><a href="exercise-2.html#group_by"><code>group_by()</code></a></li>
<li><a href="exercise-2.html#summarise"><code>summarise()</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#bring-it-all-together"><i class="fa fa-check"></i>Bring it all together…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#tasks-and-inputs-1"><i class="fa fa-check"></i>Tasks and Inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-1-getting-an-overview"><i class="fa fa-check"></i>Task 1: Getting an overview</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#input-geometry-as-columns"><i class="fa fa-check"></i>Input: Geometry as columns</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-2-deriving-movement-parameters-i-euclidean-distance-and-speed"><i class="fa fa-check"></i>Task 2: Deriving movement parameters I: Euclidean Distance and Speed</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-3-cross-scale-movement-analysis"><i class="fa fa-check"></i>Task 3: Cross-scale movement analysis</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-4-deriving-movement-parameters-ii-rolling-window-functions"><i class="fa fa-check"></i>Task 4: Deriving movement parameters II: Rolling window functions</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-5-optional-calculate-turning-angles"><i class="fa fa-check"></i>Task 5 (optional): Calculate turning angles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i>Exercise 3</a><ul>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#learning-outcomes-1"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#preperation-2"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#tasks-and-inputs-2"><i class="fa fa-check"></i>Tasks and Inputs</a><ul>
<li><a href="exercise-3.html#input-segmentation-a-la-laube2011">Input: Segmentation à la <span class="citation">Laube and Purves (2011)</span></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-1-segmentation"><i class="fa fa-check"></i>Task 1: Segmentation</a></li>
<li><a href="exercise-3.html#task-2-specify-and-apply-threshold-d">Task 2: Specify and apply threshold <em>d</em></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-3-visualize-segmented-trajectories"><i class="fa fa-check"></i>Task 3: Visualize segmented trajectories</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-4-segment-based-analysis"><i class="fa fa-check"></i>Task 4: Segment-based analysis</a></li>
<li><a href="exercise-3.html#task-4-optional-plotting-with-leaflet">Task 4 (Optional): Plotting with <code>leaflet</code></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-5-similarity-measures"><i class="fa fa-check"></i>Task 5: Similarity measures</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-6-calculate-similarity"><i class="fa fa-check"></i>Task 6: Calculate similarity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO880: Patterns and Trends in Environmental Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-3" class="section level1">
<h1>Exercise 3</h1>
<div id="learning-outcomes-1" class="section level2">
<h2>Learning Outcomes</h2>
<ul>
<li>You are able to segment a trajectory, e.g. using the approach proposed in <span class="citation">Laube and Purves (2011)</span></li>
<li>You are able to compute the similarity between given trajectories using the package <code>SimilarityMeasures.</code></li>
<li>You acquire further useful data processing skills.</li>
</ul>
</div>
<div id="prerequisites-2" class="section level2">
<h2>Prerequisites</h2>
<p>Readings Skills from “R for Data Science” <span class="citation">(Wickham and Grolemund 2017)</span>:</p>
<ul>
<li>RS3.1 Chap1 Data visualization with <code>ggplot2</code> (31, 3-35)</li>
<li>RS3.2 Chap5 Exploratory Data Analysis (28p, 81.109)</li>
</ul>
<p>Readings Theory:</p>
<p><span class="citation">Alan Both (2018)</span> A Comparative Analysis of Trajectory Similarity Measures: Recommendations for Selection and Use, in review with PLOS ONE, confidential.</p>
</div>
<div id="preperation-2" class="section level2">
<h2>Preperation</h2>
<p>Install the following libraries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;scales&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;leaflet&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;SimilarityMeasures&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)

<span class="kw">install.packages</span>(<span class="st">&quot;cowplot&quot;</span>) <span class="co"># You don&#39;t really need this package. We use it to plot subfigures</span></code></pre></div>
<p>Open your R Project from last week. Either run your own script from last week or the following lines to transform the data into the form we need for today’s exercise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(CMAtools)
<span class="kw">library</span>(sf)




<span class="co"># Import as tibble</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/wildschwein_BE.csv&quot;</span>,<span class="st">&quot;,&quot;</span>)

<span class="co"># Convert to sf-object</span>
wildschwein_BE =<span class="st"> </span><span class="kw">st_as_sf</span>(wildschwein_BE, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Long&quot;</span>, <span class="st">&quot;Lat&quot;</span>), <span class="dt">crs =</span> <span class="dv">4326</span>,<span class="dt">remove =</span> <span class="ot">FALSE</span>)

<span class="co"># transform to CH1903 LV95</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wildschwein_BE, <span class="dv">2056</span>)

<span class="co"># Add geometry as E/N integer Columns</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(wildschwein_BE) %&gt;%
<span class="st">  </span><span class="kw">cbind</span>(wildschwein_BE,.) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">E =</span> X) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">N =</span> Y)

<span class="co"># Compute timelag, steplength and speed</span>
wildschwein_BE &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">timelag =</span> <span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">lead</span>(DatetimeUTC),DatetimeUTC,<span class="dt">units =</span> <span class="st">&quot;secs&quot;</span>)),
    <span class="dt">steplength =</span> <span class="kw">euclid</span>(<span class="kw">lead</span>(E, <span class="dv">1</span>),<span class="kw">lead</span>(N, <span class="dv">1</span>),E,N),
    <span class="dt">speed =</span> steplength/timelag
  )</code></pre></div>
</div>
<div id="tasks-and-inputs-2" class="section level2">
<h2>Tasks and Inputs</h2>
<div id="input-segmentation-a-la-laube2011" class="section level3">
<h3>Input: Segmentation à la <span class="citation">Laube and Purves (2011)</span></h3>
<p>You’ve read <span class="citation">Laube and Purves (2011)</span> about segmenting trajectories. In the paper, they define “<em>static</em>” fixes as “<em>those whose average Euclidean distance to other fixes inside a temporal window v is less than some threshold d</em>”, as illustrated in the following figure:</p>
<div class="figure">
<img src="02_Images/laube_2011.jpg" alt="Laube and Purves (2011)" />
<p class="caption"><span class="citation">Laube and Purves (2011)</span></p>
</div>
<ol style="list-style-type: lower-alpha">
<li>Temporal representation of constant sample interval with associated temporal window v for three exemplary points;</li>
<li>Measurement of average distance in temporal window v to sample points in spatial representation;</li>
<li>Removal of all points where average distance is less than a given threshold, i.e. removal of static points; and</li>
<li>Removal of subtrajectories with less than a threshold temporal length.</li>
</ol>
<p>We will implement this method on some dummy data. Once you’ve grasped the idea on this simple data, you will implement it for the wild boar data in task 1.</p>
<div id="segmenting" class="section level4">
<h4>Segmenting</h4>
<p>The first step is calculating the distances to samples within the temporal window <em>v</em>. Take the follwing sample data, assuming the sampling interval is 5 minutes. If we take a temporal window of 20 minutes, that would mean including 5 fixes. We need to calculate the following Euclidean distances (pos representing a <code>X</code>,<code>Y</code>-position):</p>
<ol style="list-style-type: decimal">
<li><code>pos[n-2</code>] to <code>pos[n]</code></li>
<li><code>pos[n-1]</code> to <code>pos[n]</code></li>
<li><code>pos[n]</code> to <code>pos[n+1]</code></li>
<li><code>pos[n]</code> to <code>pos[n+2]</code></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">10</span>)

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">X =</span> <span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>)), <span class="dt">Y =</span> <span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>)))

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(X,Y)) +
<span class="st">  </span><span class="kw">geom_path</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>You can use the function <code>euclid()</code> from the package <code>CMAtools</code> for calculating the distances and <code>dplyr</code> functions <code>lead()</code>/<code>lag()</code> to create the necessary offsets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df &lt;-<span class="st"> </span>df %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">nMinus2 =</span> <span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">2</span>),<span class="kw">lag</span>(Y, <span class="dv">2</span>),X,Y),   <span class="co"># distance to pos -10 minutes</span>
    <span class="dt">nMinus1 =</span> <span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">1</span>),<span class="kw">lag</span>(Y, <span class="dv">1</span>),X,Y),   <span class="co"># distance to pos - 5 minutes</span>
    <span class="dt">nPlus1  =</span> <span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">1</span>),<span class="kw">lead</span>(Y, <span class="dv">1</span>)), <span class="co"># distance to pos + 5 mintues</span>
    <span class="dt">nPlus2  =</span> <span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">2</span>),<span class="kw">lead</span>(Y, <span class="dv">2</span>))  <span class="co"># distance to pos +10 minutes</span>
  ) </code></pre></div>
<p>Now we want to calculate the mean distance of <code>nMinus2</code>, <code>nMinus1</code>, <code>nPlus1</code>, <code>nPlus2</code>. Since we want the mean value <em>per Row</em>, we have to explicitly specify this before <code>mutate()</code>. Without <code>rowwise()</code>, mutate calculates the overall mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>df %&gt;%
<span class="st">  </span><span class="kw">rowwise</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">stepMean =</span> <span class="kw">mean</span>(<span class="kw">c</span>(nMinus2, nMinus1,nPlus1,nPlus2), <span class="dt">na.rm =</span> T)
  )</code></pre></div>
<p>We can now determin if an animal is moving or not by specifying a threshold on <code>stepMean</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df &lt;-<span class="st"> </span>df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">moving =</span> stepMean&gt;<span class="fl">1.5</span>
    )

df
## Source: local data frame [10 x 8]
## Groups: &lt;by row&gt;
## 
## # A tibble: 10 x 8
##          X     Y nMinus2 nMinus1 nPlus1 nPlus2 stepMean moving
##      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt; 
##  1  0.0187  1.10   NA     NA      0.778   1.64     1.21 FALSE 
##  2 -0.166   1.86   NA      0.778  1.39    2.11     1.43 FALSE 
##  3 -1.54    1.62    1.64   1.39   1.16    1.76     1.49 FALSE 
##  4 -2.14    2.61    2.11   1.16   0.798   1.08     1.28 FALSE 
##  5 -1.84    3.35    1.76   0.798  0.400   1.19     1.04 FALSE 
##  6 -1.45    3.44    1.08   0.400  1.54    1.95     1.24 FALSE 
##  7 -2.66    2.48    1.19   1.54   0.413   2.12     1.32 FALSE 
##  8 -3.02    2.29    1.95   0.413  1.87    2.35     1.65 TRUE  
##  9 -4.65    3.21    2.12   1.87   0.547  NA        1.51 TRUE  
## 10 -4.91    3.70    2.35   0.547 NA      NA        1.45 FALSE</code></pre></div>
</div>
<div id="unique-ids-per-segment" class="section level4">
<h4>Unique IDs <em>per segment</em></h4>
<p>When segmenting trajectories, we often want to compute metrics on the basis of <em>each segment</em>. Within the tidyverse logic, we need a unique ID per segment that we can pass to <code>group_by()</code>. So far, we’ve not found a good solution from available packages. We have therefore created our own function that we provide with the <code>CMAtools</code> package called <code>number_groups()</code>. This function takes a logical vector as an input and assigns subsequent <code>TRUE</code> values to the same group. Take the sample trajectory from before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df
## Source: local data frame [10 x 8]
## Groups: &lt;by row&gt;
## 
## # A tibble: 10 x 8
##          X     Y nMinus2 nMinus1 nPlus1 nPlus2 stepMean moving
##      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt; 
##  1  0.0187  1.10   NA     NA      0.778   1.64     1.21 FALSE 
##  2 -0.166   1.86   NA      0.778  1.39    2.11     1.43 FALSE 
##  3 -1.54    1.62    1.64   1.39   1.16    1.76     1.49 FALSE 
##  4 -2.14    2.61    2.11   1.16   0.798   1.08     1.28 FALSE 
##  5 -1.84    3.35    1.76   0.798  0.400   1.19     1.04 FALSE 
##  6 -1.45    3.44    1.08   0.400  1.54    1.95     1.24 FALSE 
##  7 -2.66    2.48    1.19   1.54   0.413   2.12     1.32 FALSE 
##  8 -3.02    2.29    1.95   0.413  1.87    2.35     1.65 TRUE  
##  9 -4.65    3.21    2.12   1.87   0.547  NA        1.51 TRUE  
## 10 -4.91    3.70    2.35   0.547 NA      NA        1.45 FALSE</code></pre></div>
<p>We can now assign unique IDs to a sequence of <code>TRUE</code>-values with the function <code>number_groups()</code>. Use <code>?number_groups</code> to get more information on this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>df %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%<span class="st">  </span><span class="co"># to remove the rowwise grouping</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">moving_group =</span> <span class="kw">number_groups</span>(moving)
  )

df
## # A tibble: 10 x 9
##          X     Y nMinus2 nMinus1 nPlus1 nPlus2 stepMean moving
##      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt; 
##  1  0.0187  1.10   NA     NA      0.778   1.64     1.21 FALSE 
##  2 -0.166   1.86   NA      0.778  1.39    2.11     1.43 FALSE 
##  3 -1.54    1.62    1.64   1.39   1.16    1.76     1.49 FALSE 
##  4 -2.14    2.61    2.11   1.16   0.798   1.08     1.28 FALSE 
##  5 -1.84    3.35    1.76   0.798  0.400   1.19     1.04 FALSE 
##  6 -1.45    3.44    1.08   0.400  1.54    1.95     1.24 FALSE 
##  7 -2.66    2.48    1.19   1.54   0.413   2.12     1.32 FALSE 
##  8 -3.02    2.29    1.95   0.413  1.87    2.35     1.65 TRUE  
##  9 -4.65    3.21    2.12   1.87   0.547  NA        1.51 TRUE  
## 10 -4.91    3.70    2.35   0.547 NA      NA        1.45 FALSE 
## # ... with 1 more variable: moving_group &lt;fct&gt;</code></pre></div>
</div>
</div>
<div id="task-1-segmentation" class="section level3">
<h3>Task 1: Segmentation</h3>
<p>With the skills from the inout above we can now implement the segmentation algorithm described in <span class="citation">Laube and Purves (2011)</span>. The desribed method depends on a regular sampling interval. Therefore you have to subset your data to a trajectory of the same sampling intervals. Do so by subsetting the data the same way as we did in Task 3 last week:</p>
<ol style="list-style-type: decimal">
<li>filter the to positions with a sampling interval between 40 and 80 seconds</li>
<li>subset the first 100 locations</li>
<li>save these positions to a new variable (we will again use <code>wildschwein_BE_1</code>)</li>
</ol>
<p>Next, we have to have to define our <em>temporal window v</em> <span class="citation">(Laube and Purves 2011)</span>. To keep things simple, I would suggest a window of n +/- 2 minutes. With a sampling interval of around 1 minute, this corresponds to a window size of n +/- 2 positions.</p>
</div>
<div id="task-2-specify-and-apply-threshold-d" class="section level3">
<h3>Task 2: Specify and apply threshold <em>d</em></h3>
<p>After calculating the Euclidean distances to positions with the temporal window <em>v</em> in task 1, you can explore these values (we stored them in the column <code>stepMean</code>) using summary statistics (histograms, boxplot, <code>summary()</code>): This way we can define a reasonable threshold value to differentiate between “stops” and “moves”. There is no “correct” way of doing this, specifying a threshold always depends on data as well as the question that needs to be answered.</p>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   1.121   2.596   3.444   6.964   5.745  60.359       4</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<pre><code>## Simple feature collection with 99 features and 6 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 2568493 ymin: 1203920 xmax: 2570770 ymax: 1205937
## epsg (SRID):    2056
## proj4string:    +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs
## # A tibble: 99 x 7
## # Groups:   TierID [1]
##    TierID DatetimeUTC                E        N stepMean movement
##    &lt;chr&gt;  &lt;dttm&gt;                 &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;   
##  1 010C   2015-09-15 08:08:00 2570573. 1205096.    NA    NA      
##  2 010C   2015-09-15 08:09:00 2570536. 1205099.    NA    NA      
##  3 010C   2015-09-15 08:10:00 2570518. 1205115.    35.1  TRUE    
##  4 010C   2015-09-15 08:11:00 2570499. 1205130.    25.4  TRUE    
##  5 010C   2015-09-15 08:12:00 2570489. 1205130.    18.8  TRUE    
##  6 010C   2015-09-15 08:13:00 2570482. 1205124.    16.9  TRUE    
##  7 010C   2015-09-15 08:14:00 2570481. 1205108.    15.4  TRUE    
##  8 010C   2015-09-15 08:15:00 2570486. 1205099.    12.9  TRUE    
##  9 010C   2015-09-15 08:16:00 2570490. 1205100.    10.3  TRUE    
## 10 010C   2015-09-15 08:17:00 2570495. 1205091.     7.24 TRUE    
## # ... with 89 more rows, and 1 more variable: geometry &lt;POINT [m]&gt;</code></pre>
</div>
<div id="task-3-visualize-segmented-trajectories" class="section level3">
<h3>Task 3: Visualize segmented trajectories</h3>
<p>Now visualize the segmented trajectories spatially. Just like last week, you can use ggplot with <code>geom_path()</code>, <code>geom_point()</code> and <code>coord_equal()</code>. Assign <code>colour = movement</code> within <code>aes()</code> to distinguish between segements <em>with</em> “movement” and <em>without</em>.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /> Tipp: if you want to get a <code>ggplot()</code> with Zoom capability, just load the library <code>plotly</code> and wrap the <code>ggplot()</code> function with <code>ggplotly()</code></p>
<div class="figure"><span id="fig:unnamed-chunk-88"></span>
<div id="148f0696d9404" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="148f0696d9404">{"x":{"data":[{"x":[2570572.81286501,2570536.36392834,2570517.57904994,2570498.79421657,2570488.86599919,2570482.14023517,2570480.83903491,2570486.25607874,2570490.47525942,2570495.40465199,2570499.12265696,2570497.39568949,2570498.87799551,2570498.87121438,2570499.12943803,2570502.58922161,2570499.87527911,2570500.11729119,2570497.38896315,2570498.6273779,2570495.66199703,2570495.4181607,2570497.14512672,2570497.14512672,2570498.87121438,2570499.12265696,2570498.87799551,2570496.88772712,2570496.39922959,2570495.41137877,2570494.17786355,2570494.6655365,2570496.15727578,2570496.1640024,2570492.43066144,2570493.92051768,2570497.65308868,2570496.90807187,2570497.14512672,2570498.87799551,2570498.6273779,2570498.38354142,2570496.14866646,2570497.40737076,2570499.64229973,2570502.12183464,2570496.14866646,2570498.62059672,2570498.63415909,2570496.40601128,2570497.89504367,2570500.86903251,2570499.88206001,2570498.38354142,2570495.16759752,2570498.88472151,2570499.13616397,2570496.8945087,2570497.39568949,2570497.14512672,2570497.14512672,2570497.64630727,2570504.82415047,2570574.0850662,2570617.68492948,2570619.89962866,2570625.58763573,2570624.57103816,2570619.84398717,2570618.35408955,2570623.08874665,2570625.08651639,2570623.10219701,2570600.07763973,2570594.13145438,2570597.58458655,2570597.83512517,2570597.83512517,2570599.08708749,2570597.58458655,2570599.34528671,2570597.59804858,2570597.82166325,2570600.06412388,2570596.11576868,2570596.3595487,2570593.88677261,2570593.6496421,2570597.84864204,2570594.13145438,2570591.91006497,2570594.13815871,2570591.65186403,2570589.43047523,2570593.64293766,2570594.13145438,2570597.88908275,2570595.66769532,2570596.40675024],"y":[1205095.54900512,1205098.69774095,1205114.57738163,1205130.44596488,1205130.02828242,1205123.52467662,1205108.08919718,1205099.16847572,1205100.23704047,1205091.14086973,1205089.31031,1205092.30942926,1205090.59001326,1205089.2226185,1205090.67770475,1205087.39206093,1205092.29713247,1205087.4154359,1205090.95315152,1205089.1348893,1205093.95227129,1205093.86454222,1205090.86542238,1205090.86542238,1205089.2226185,1205089.31031,1205090.59001326,1205088.04290374,1205089.23487798,1205092.49714746,1205090.70226225,1205090.8777203,1205094.12769175,1205095.48396948,1205089.62143274,1205087.89086076,1205095.13194794,1205092.14508801,1205090.86542238,1205090.59001326,1205089.1348893,1205089.0471601,1205087.79087116,1205090.06367591,1205091.33108237,1205091.30766949,1205087.79087116,1205087.76749454,1205090.50228406,1205090.60227274,1205090.23913423,1205091.75857395,1205093.66452724,1205089.0471601,1205092.42053543,1205091.94629099,1205092.03398249,1205089.41029849,1205092.30942926,1205090.86542238,1205090.86542238,1205093.76455317,1205088.65946933,1205100.55661582,1205086.83358296,1205084.00996685,1205080.62445189,1205073.45881167,1205068.12361624,1205069.8541567,1205075.1893134,1205077.7253104,1205077.91298612,1205088.63264013,1205090.56308908,1205085.92122255,1205087.36523363,1205087.36523363,1205088.28178201,1205085.92122255,1205089.7368726,1205088.64489525,1205084.64156093,1205085.89785039,1205090.37540373,1205090.45201989,1205091.84278845,1205093.11133321,1205090.10002337,1205090.56308908,1205092.03043695,1205091.91936693,1205090.57534668,1205092.04269547,1205091.75505537,1205090.56308908,1205098.28215861,1205099.74950509,1205100.00155001],"text":["~E: 2570573<br />~N: 1205096<br />~.group: ~","~E: 2570536<br />~N: 1205099<br />~.group: ~","~E: 2570518<br />~N: 1205115<br />~.group: ~","~E: 2570499<br />~N: 1205130<br />~.group: ~","~E: 2570489<br />~N: 1205130<br />~.group: ~","~E: 2570482<br />~N: 1205124<br />~.group: ~","~E: 2570481<br />~N: 1205108<br />~.group: ~","~E: 2570486<br />~N: 1205099<br />~.group: ~","~E: 2570490<br />~N: 1205100<br />~.group: ~","~E: 2570495<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~.group: ~","~E: 2570503<br />~N: 1205087<br />~.group: ~","~E: 2570500<br />~N: 1205092<br />~.group: ~","~E: 2570500<br />~N: 1205087<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570496<br />~N: 1205094<br />~.group: ~","~E: 2570495<br />~N: 1205094<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~.group: ~","~E: 2570497<br />~N: 1205088<br />~.group: ~","~E: 2570496<br />~N: 1205089<br />~.group: ~","~E: 2570495<br />~N: 1205092<br />~.group: ~","~E: 2570494<br />~N: 1205091<br />~.group: ~","~E: 2570495<br />~N: 1205091<br />~.group: ~","~E: 2570496<br />~N: 1205094<br />~.group: ~","~E: 2570496<br />~N: 1205095<br />~.group: ~","~E: 2570492<br />~N: 1205090<br />~.group: ~","~E: 2570494<br />~N: 1205088<br />~.group: ~","~E: 2570498<br />~N: 1205095<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~.group: ~","~E: 2570498<br />~N: 1205089<br />~.group: ~","~E: 2570496<br />~N: 1205088<br />~.group: ~","~E: 2570497<br />~N: 1205090<br />~.group: ~","~E: 2570500<br />~N: 1205091<br />~.group: ~","~E: 2570502<br />~N: 1205091<br />~.group: ~","~E: 2570496<br />~N: 1205088<br />~.group: ~","~E: 2570499<br />~N: 1205088<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~.group: ~","~E: 2570496<br />~N: 1205091<br />~.group: ~","~E: 2570498<br />~N: 1205090<br />~.group: ~","~E: 2570501<br />~N: 1205092<br />~.group: ~","~E: 2570500<br />~N: 1205094<br />~.group: ~","~E: 2570498<br />~N: 1205089<br />~.group: ~","~E: 2570495<br />~N: 1205092<br />~.group: ~","~E: 2570499<br />~N: 1205092<br />~.group: ~","~E: 2570499<br />~N: 1205092<br />~.group: ~","~E: 2570497<br />~N: 1205089<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~.group: ~","~E: 2570498<br />~N: 1205094<br />~.group: ~","~E: 2570505<br />~N: 1205089<br />~.group: ~","~E: 2570574<br />~N: 1205101<br />~.group: ~","~E: 2570618<br />~N: 1205087<br />~.group: ~","~E: 2570620<br />~N: 1205084<br />~.group: ~","~E: 2570626<br />~N: 1205081<br />~.group: ~","~E: 2570625<br />~N: 1205073<br />~.group: ~","~E: 2570620<br />~N: 1205068<br />~.group: ~","~E: 2570618<br />~N: 1205070<br />~.group: ~","~E: 2570623<br />~N: 1205075<br />~.group: ~","~E: 2570625<br />~N: 1205078<br />~.group: ~","~E: 2570623<br />~N: 1205078<br />~.group: ~","~E: 2570600<br />~N: 1205089<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~.group: ~","~E: 2570598<br />~N: 1205086<br />~.group: ~","~E: 2570598<br />~N: 1205087<br />~.group: ~","~E: 2570598<br />~N: 1205087<br />~.group: ~","~E: 2570599<br />~N: 1205088<br />~.group: ~","~E: 2570598<br />~N: 1205086<br />~.group: ~","~E: 2570599<br />~N: 1205090<br />~.group: ~","~E: 2570598<br />~N: 1205089<br />~.group: ~","~E: 2570598<br />~N: 1205085<br />~.group: ~","~E: 2570600<br />~N: 1205086<br />~.group: ~","~E: 2570596<br />~N: 1205090<br />~.group: ~","~E: 2570596<br />~N: 1205090<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~.group: ~","~E: 2570594<br />~N: 1205093<br />~.group: ~","~E: 2570598<br />~N: 1205090<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~.group: ~","~E: 2570592<br />~N: 1205092<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~.group: ~","~E: 2570592<br />~N: 1205091<br />~.group: ~","~E: 2570589<br />~N: 1205092<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~.group: ~","~E: 2570598<br />~N: 1205098<br />~.group: ~","~E: 2570596<br />~N: 1205100<br />~.group: ~","~E: 2570596<br />~N: 1205100<br />~.group: ~"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,0.5)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2570499.12265696,2570497.39568949,2570498.87799551,2570498.87121438,2570499.12943803,2570502.58922161,2570499.87527911,2570500.11729119,2570497.38896315,2570498.6273779,2570495.66199703,2570495.4181607,2570497.14512672,2570497.14512672,2570498.87121438,2570499.12265696,2570498.87799551,2570496.88772712,2570496.39922959,2570495.41137877,2570494.17786355,2570494.6655365,2570496.15727578,2570496.1640024,2570492.43066144,2570493.92051768,2570497.65308868,2570496.90807187,2570497.14512672,2570498.87799551,2570498.6273779,2570498.38354142,2570496.14866646,2570497.40737076,2570499.64229973,2570502.12183464,2570496.14866646,2570498.62059672,2570498.63415909,2570496.40601128,2570497.89504367,2570500.86903251,2570499.88206001,2570498.38354142,2570495.16759752,2570498.88472151,2570499.13616397,2570496.8945087,2570497.39568949,2570497.14512672,2570497.14512672,2570618.35408955,2570623.08874665,2570597.58458655,2570597.83512517,2570597.83512517,2570599.08708749,2570597.58458655,2570599.34528671,2570597.59804858,2570597.82166325,2570600.06412388,2570596.11576868,2570596.3595487,2570593.88677261,2570593.6496421,2570597.84864204,2570594.13145438,2570591.91006497,2570594.13815871,2570591.65186403,2570589.43047523,2570593.64293766,2570594.13145438,2570597.88908275],"y":[1205089.31031,1205092.30942926,1205090.59001326,1205089.2226185,1205090.67770475,1205087.39206093,1205092.29713247,1205087.4154359,1205090.95315152,1205089.1348893,1205093.95227129,1205093.86454222,1205090.86542238,1205090.86542238,1205089.2226185,1205089.31031,1205090.59001326,1205088.04290374,1205089.23487798,1205092.49714746,1205090.70226225,1205090.8777203,1205094.12769175,1205095.48396948,1205089.62143274,1205087.89086076,1205095.13194794,1205092.14508801,1205090.86542238,1205090.59001326,1205089.1348893,1205089.0471601,1205087.79087116,1205090.06367591,1205091.33108237,1205091.30766949,1205087.79087116,1205087.76749454,1205090.50228406,1205090.60227274,1205090.23913423,1205091.75857395,1205093.66452724,1205089.0471601,1205092.42053543,1205091.94629099,1205092.03398249,1205089.41029849,1205092.30942926,1205090.86542238,1205090.86542238,1205069.8541567,1205075.1893134,1205085.92122255,1205087.36523363,1205087.36523363,1205088.28178201,1205085.92122255,1205089.7368726,1205088.64489525,1205084.64156093,1205085.89785039,1205090.37540373,1205090.45201989,1205091.84278845,1205093.11133321,1205090.10002337,1205090.56308908,1205092.03043695,1205091.91936693,1205090.57534668,1205092.04269547,1205091.75505537,1205090.56308908,1205098.28215861],"text":["~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570503<br />~N: 1205087<br />~movement: FALSE<br />~.group: ~","~E: 2570500<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570500<br />~N: 1205087<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205094<br />~movement: FALSE<br />~.group: ~","~E: 2570495<br />~N: 1205094<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570495<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570494<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570495<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205094<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205095<br />~movement: FALSE<br />~.group: ~","~E: 2570492<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570494<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570498<br />~N: 1205095<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570498<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570500<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570502<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570496<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570498<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570501<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570500<br />~N: 1205094<br />~movement: FALSE<br />~.group: ~","~E: 2570498<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570495<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570499<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570497<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570618<br />~N: 1205070<br />~movement: FALSE<br />~.group: ~","~E: 2570623<br />~N: 1205075<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205086<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205087<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205087<br />~movement: FALSE<br />~.group: ~","~E: 2570599<br />~N: 1205088<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205086<br />~movement: FALSE<br />~.group: ~","~E: 2570599<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205089<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205085<br />~movement: FALSE<br />~.group: ~","~E: 2570600<br />~N: 1205086<br />~movement: FALSE<br />~.group: ~","~E: 2570596<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570596<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205093<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205090<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570592<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570592<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570589<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205092<br />~movement: FALSE<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~movement: FALSE<br />~.group: ~","~E: 2570598<br />~N: 1205098<br />~movement: FALSE<br />~.group: ~"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"FALSE","legendgroup":"FALSE","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2570517.57904994,2570498.79421657,2570488.86599919,2570482.14023517,2570480.83903491,2570486.25607874,2570490.47525942,2570495.40465199,2570497.64630727,2570504.82415047,2570574.0850662,2570617.68492948,2570619.89962866,2570625.58763573,2570624.57103816,2570619.84398717,2570625.08651639,2570623.10219701,2570600.07763973,2570594.13145438],"y":[1205114.57738163,1205130.44596488,1205130.02828242,1205123.52467662,1205108.08919718,1205099.16847572,1205100.23704047,1205091.14086973,1205093.76455317,1205088.65946933,1205100.55661582,1205086.83358296,1205084.00996685,1205080.62445189,1205073.45881167,1205068.12361624,1205077.7253104,1205077.91298612,1205088.63264013,1205090.56308908],"text":["~E: 2570518<br />~N: 1205115<br />~movement:  TRUE<br />~.group: ~","~E: 2570499<br />~N: 1205130<br />~movement:  TRUE<br />~.group: ~","~E: 2570489<br />~N: 1205130<br />~movement:  TRUE<br />~.group: ~","~E: 2570482<br />~N: 1205124<br />~movement:  TRUE<br />~.group: ~","~E: 2570481<br />~N: 1205108<br />~movement:  TRUE<br />~.group: ~","~E: 2570486<br />~N: 1205099<br />~movement:  TRUE<br />~.group: ~","~E: 2570490<br />~N: 1205100<br />~movement:  TRUE<br />~.group: ~","~E: 2570495<br />~N: 1205091<br />~movement:  TRUE<br />~.group: ~","~E: 2570498<br />~N: 1205094<br />~movement:  TRUE<br />~.group: ~","~E: 2570505<br />~N: 1205089<br />~movement:  TRUE<br />~.group: ~","~E: 2570574<br />~N: 1205101<br />~movement:  TRUE<br />~.group: ~","~E: 2570618<br />~N: 1205087<br />~movement:  TRUE<br />~.group: ~","~E: 2570620<br />~N: 1205084<br />~movement:  TRUE<br />~.group: ~","~E: 2570626<br />~N: 1205081<br />~movement:  TRUE<br />~.group: ~","~E: 2570625<br />~N: 1205073<br />~movement:  TRUE<br />~.group: ~","~E: 2570620<br />~N: 1205068<br />~movement:  TRUE<br />~.group: ~","~E: 2570625<br />~N: 1205078<br />~movement:  TRUE<br />~.group: ~","~E: 2570623<br />~N: 1205078<br />~movement:  TRUE<br />~.group: ~","~E: 2570600<br />~N: 1205089<br />~movement:  TRUE<br />~.group: ~","~E: 2570594<br />~N: 1205091<br />~movement:  TRUE<br />~.group: ~"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":" TRUE","legendgroup":" TRUE","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2570572.81286501,2570536.36392834,2570595.66769532,2570596.40675024],"y":[1205095.54900512,1205098.69774095,1205099.74950509,1205100.00155001],"text":["~E: 2570573<br />~N: 1205096<br />~movement:    NA<br />~.group: ~","~E: 2570536<br />~N: 1205099<br />~movement:    NA<br />~.group: ~","~E: 2570596<br />~N: 1205100<br />~movement:    NA<br />~.group: ~","~E: 2570596<br />~N: 1205100<br />~movement:    NA<br />~.group: ~"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(127,127,127,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(127,127,127,1)"}},"hoveron":"points","name":"NA","legendgroup":"NA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":66.4840182648402},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[2570473.60160487,2570632.82506577],"tickmode":"array","ticktext":["2570480","2570520","2570560","2570600"],"tickvals":[2570480,2570520,2570560,2570600],"categoryorder":"array","categoryarray":["2570480","2570520","2570560","2570600"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"E","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"scaleanchor":"y","scaleratio":1,"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[1205065.00749881,1205133.56208231],"tickmode":"array","ticktext":["1205080","1205100","1205120"],"tickvals":[1205080,1205100,1205120],"categoryorder":"array","categoryarray":["1205080","1205100","1205120"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"N","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"scaleanchor":"x","scaleratio":1,"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"movement","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"148f04e318767":{"x":{},"y":{},"type":"scatter"},"148f035ad6aea":{"x":{},"y":{},"colour":{}}},"cur_data":"148f04e318767","visdat":{"148f04e318767":["function (y) ","x"],"148f035ad6aea":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 1: This is the same plot as above, wrapped in the function <code>ggplotly()</code> from the library <code>plotly</code>. With this function, the plot becomes interactive. Try it out!
</p>
</div>
</div>
<div id="task-4-segment-based-analysis" class="section level3">
<h3>Task 4: Segment-based analysis</h3>
<p>In applying <span class="citation">Laube and Purves (2011)</span>, we’ve come as far as steps (b)/(c) in <a href="02_Images/laube_2011.jpg">Figure 1</a>. In order to complete step (d) (<em>Removal of subtrajectories with less than a threshold temporal length</em>), we first should be able to perform calculations per <em>segment</em>. This is currently not the case.</p>
<p>What we are lacking is a unique name for each segment that we can use as a grouping variable. This is where the <code>number_group()</code> function which we introduced in the input becomes handy. Complete the following steps:</p>
<ol style="list-style-type: decimal">
<li>Apply the function <code>number_group()</code> on the column <code>movement</code> to get a unique ID per segement and store this ID in the column <code>segment_ID</code></li>
<li>Use this column within <code>group_by()</code> to calculate the temporal length of each segment</li>
<li>Remove segments with a duration less than 5 minutes / 300 seconds</li>
<li>visualize the new dataset</li>
</ol>
<div class="figure"><span id="fig:unnamed-chunk-90"></span>
<img src="_main_files/figure-html/unnamed-chunk-90-1.png" alt="(a): Differentiate between move/stop based on temporal window 4 minutes and a threshold of 7 meters. (b): Removal of points where avarage distance is less than 7 meters. (c): Removal of Subtrajectories with less than a temporal length of 5 minutes." width="672" />
<p class="caption">
Figure 2: (a): Differentiate between move/stop based on temporal window 4 minutes and a threshold of 7 meters. (b): Removal of points where avarage distance is less than 7 meters. (c): Removal of Subtrajectories with less than a temporal length of 5 minutes.
</p>
</div>
</div>
<div id="task-4-optional-plotting-with-leaflet" class="section level3">
<h3>Task 4 (Optional): Plotting with <code>leaflet</code></h3>
<p>Exploring segmentation with <code>ggplot</code> is not very satisfying. Another great tool to visualize spatial data is leaflet. It’s not all that hard to create an interactive leaflet plot, just take a look at <a href="https://rstudio.github.io/leaflet/">the documentation</a> and try it with your segmented wild boar data. Note: You can only pass the <code>Lat</code>/<code>Long</code> coordinates to leaflet, it cannot handle our <code>E</code>/<code>N</code>-data. This is one of the reasons we’ve held on to this column in the first place.</p>
<div class="figure"><span id="fig:unnamed-chunk-92"></span>
<div id="htmlwidget-463a03ba3f29047c1acd" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-463a03ba3f29047c1acd">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addCircles","args":[[46.9962616,46.9962883,46.9964303,46.9965722,46.996568,46.9965092,46.9963703,46.9962903,46.9963001,46.9962185,46.9962022,46.9962291,46.9962137,46.9962014,46.9962145,46.9961851,46.9962291,46.9961852,46.9962169,46.9962006,46.9962438,46.996243,46.9962161,46.9962161,46.9962014,46.9962022,46.9962137,46.9961907,46.9962014,46.9962307,46.9962145,46.9962161,46.9962454,46.9962576,46.9962047,46.9961892,46.9962545,46.9962276,46.9962161,46.9962137,46.9962006,46.9961998,46.9961884,46.9962089,46.9962204,46.9962203,46.9961884,46.9961883,46.9962129,46.9962137,46.9962105,46.9962243,46.9962414,46.9961998,46.99623,46.9962259,46.9962267,46.996203,46.9962291,46.9962161,46.9962161,46.9962422,46.9961966,46.9963067,46.9961852,46.9961599,46.9961297,46.9960652,46.996017,46.9960325,46.9960807,46.9961036,46.9961052,46.9962006,46.9962177,46.9961761,46.9961891,46.9961891,46.9961974,46.9961761,46.9962105,46.9962006,46.9961646,46.996176,46.9962161,46.9962168,46.9962292,46.9962406,46.9962137,46.9962177,46.9962308,46.9962299,46.9962177,46.9962308,46.9962284,46.9962177,46.9962873,46.9963004,46.9963027],[7.0517454,7.051266,7.051018,7.05077,7.0506395,7.0505515,7.0505354,7.0506072,7.0506626,7.050728,7.050777,7.0507541,7.0507737,7.0507737,7.050777,7.0508227,7.0507867,7.0507902,7.0507541,7.0507705,7.0507312,7.050728,7.0507509,7.0507509,7.0507737,7.050777,7.0507737,7.0507477,7.0507412,7.050728,7.0507119,7.0507183,7.0507377,7.0507377,7.050689,7.0507087,7.0507573,7.0507477,7.0507509,7.0507737,7.0507705,7.0507673,7.050738,7.0507544,7.0507837,7.0508163,7.050738,7.0507705,7.0507705,7.0507412,7.0507608,7.0507998,7.0507867,7.0507673,7.0507248,7.0507737,7.050777,7.0507477,7.0507541,7.0507509,7.0507509,7.0507573,7.050852,7.0517618,7.0523359,7.0523652,7.0524402,7.0524273,7.0523655,7.0523458,7.0524077,7.0524338,7.0524077,7.0521043,7.052026,7.0520717,7.0520749,7.0520749,7.0520913,7.0520717,7.0520946,7.0520717,7.0520749,7.0521043,7.0520521,7.0520553,7.0520227,7.0520195,7.0520749,7.052026,7.0519967,7.052026,7.0519934,7.0519641,7.0520195,7.052026,7.0520749,7.0520456,7.0520553],1,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":["#808080","#808080","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#808080","#808080"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#808080","#808080","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#619CFF","#619CFF","#619CFF","#619CFF","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#808080","#808080"],"fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null]},{"method":"addPolylines","args":[[[[{"lng":[7.0517454,7.051266,7.051018,7.05077,7.0506395,7.0505515,7.0505354,7.0506072,7.0506626,7.050728,7.050777,7.0507541,7.0507737,7.0507737,7.050777,7.0508227,7.0507867,7.0507902,7.0507541,7.0507705,7.0507312,7.050728,7.0507509,7.0507509,7.0507737,7.050777,7.0507737,7.0507477,7.0507412,7.050728,7.0507119,7.0507183,7.0507377,7.0507377,7.050689,7.0507087,7.0507573,7.0507477,7.0507509,7.0507737,7.0507705,7.0507673,7.050738,7.0507544,7.0507837,7.0508163,7.050738,7.0507705,7.0507705,7.0507412,7.0507608,7.0507998,7.0507867,7.0507673,7.0507248,7.0507737,7.050777,7.0507477,7.0507541,7.0507509,7.0507509,7.0507573,7.050852,7.0517618,7.0523359,7.0523652,7.0524402,7.0524273,7.0523655,7.0523458,7.0524077,7.0524338,7.0524077,7.0521043,7.052026,7.0520717,7.0520749,7.0520749,7.0520913,7.0520717,7.0520946,7.0520717,7.0520749,7.0521043,7.0520521,7.0520553,7.0520227,7.0520195,7.0520749,7.052026,7.0519967,7.052026,7.0519934,7.0519641,7.0520195,7.052026,7.0520749,7.0520456,7.0520553],"lat":[46.9962616,46.9962883,46.9964303,46.9965722,46.996568,46.9965092,46.9963703,46.9962903,46.9963001,46.9962185,46.9962022,46.9962291,46.9962137,46.9962014,46.9962145,46.9961851,46.9962291,46.9961852,46.9962169,46.9962006,46.9962438,46.996243,46.9962161,46.9962161,46.9962014,46.9962022,46.9962137,46.9961907,46.9962014,46.9962307,46.9962145,46.9962161,46.9962454,46.9962576,46.9962047,46.9961892,46.9962545,46.9962276,46.9962161,46.9962137,46.9962006,46.9961998,46.9961884,46.9962089,46.9962204,46.9962203,46.9961884,46.9961883,46.9962129,46.9962137,46.9962105,46.9962243,46.9962414,46.9961998,46.99623,46.9962259,46.9962267,46.996203,46.9962291,46.9962161,46.9962161,46.9962422,46.9961966,46.9963067,46.9961852,46.9961599,46.9961297,46.9960652,46.996017,46.9960325,46.9960807,46.9961036,46.9961052,46.9962006,46.9962177,46.9961761,46.9961891,46.9961891,46.9961974,46.9961761,46.9962105,46.9962006,46.9961646,46.996176,46.9962161,46.9962168,46.9962292,46.9962406,46.9962137,46.9962177,46.9962308,46.9962299,46.9962177,46.9962308,46.9962284,46.9962177,46.9962873,46.9963004,46.9963027]}]]],null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.1,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false},null,null,null,null,null]},{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addLegend","args":[{"colors":["#F8766D","#619CFF"],"labels":["FALSE","TRUE"],"na_color":"#808080","na_label":"NA","opacity":0.5,"position":"topright","type":"factor","title":"Segment","extra":null,"layerId":null,"className":"info legend"}]}],"limits":{"lat":[46.996017,46.9965722],"lng":[7.0505354,7.0524402]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 3: Visualizing ‘stops’ and ‘moves’ with a threshold of 50 m
</p>
</div>
</div>
<div id="task-5-similarity-measures" class="section level3">
<h3>Task 5: Similarity measures</h3>
<p>Import the dataset <code>pedestrian.csv</code> (available on moodle). It it a set of six similar, but varying trajectories from pedestrians walking on a path. We will analyse these trajectories with the package <code>SimilarityMeasures</code>, always comparing trajectory 1 pairwise to the other trajectories 2-6. For this task, explore the trajectories first and get an idea on how the pedestrians moved. We step away from using the wild boar data for this task because our animals don’t express the type of similarity we want to illustrate here. Also, using the constructed pedestrian data allows us illustrating very typical similarity issues, that are picked-up in different ways by the different similarity measures. In later exercises we will get back to our wild boar!</p>
<!-- Todo Nils: Traj 5 should acutally be exactly like traj 6, except for the outlier. In this way, the effect of the outlier is clearly visible. -->
<div class="figure"><span id="fig:unnamed-chunk-94"></span>
<img src="_main_files/figure-html/unnamed-chunk-94-1.png" alt="Comparing Trajectories 1 and 2" width="672" />
<p class="caption">
Figure 4: Comparing Trajectories 1 and 2
</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-95"></span>
<img src="_main_files/figure-html/unnamed-chunk-95-1.png" alt="Comparing Trajectories 1 and 3. Some positions are labeld with the position index to illustrate the direction of movement per trajectory." width="672" />
<p class="caption">
Figure 5: Comparing Trajectories 1 and 3. Some positions are labeld with the position index to illustrate the direction of movement per trajectory.
</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-96"></span>
<img src="_main_files/figure-html/unnamed-chunk-96-1.png" alt="Comparing Trajectories 1 and 4" width="672" />
<p class="caption">
Figure 6: Comparing Trajectories 1 and 4
</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-97"></span>
<img src="_main_files/figure-html/unnamed-chunk-97-1.png" alt="Comparing Trajectories 1 and 5" width="672" />
<p class="caption">
Figure 7: Comparing Trajectories 1 and 5
</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-98"></span>
<img src="_main_files/figure-html/unnamed-chunk-98-1.png" alt="Comparing Trajectories 1 and 6" width="672" />
<p class="caption">
Figure 8: Comparing Trajectories 1 and 6
</p>
</div>
</div>
<div id="task-6-calculate-similarity" class="section level3">
<h3>Task 6: Calculate similarity</h3>
<p>Calculate the similarity between trajectory 1 and trajectories 2-6. Use the different similarity measures in the package <code>SimilarityMeasures</code>.Visualize your results and try to understand the different results with respect to your reading of <span class="citation">Alan Both (2018)</span>. Can you see connections between the properties of the trajectories and the similarity values computed by the different measures?</p>
<p>Note:</p>
<ul>
<li>All functions in the package need matrices as input, with one trajectory per matrix. Therefore, split the dataframe into 6 matrices with just two columns each, <code>E</code> and <code>N</code>. You can do this with the following code:</li>
<li><code>LCSS</code>takes very long to compute. The accuracy of the algorithm (<code>pointSpacing =</code> ,<code>pointDistance =</code> and <code>errorMarg =</code>) can be varied to provide faster or slower calculations. Please see <span class="citation">Vlachos, Gunopoulos, and Kollios (2002)</span> for more information.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">traj1 &lt;-<span class="st"> </span>pedestrians %&gt;%
<span class="st">      </span><span class="kw">filter</span>(TrajID ==<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="co"># Change value 1 to 2,3 etc to  </span>
<span class="st">      </span><span class="kw">as.data.frame</span>() %&gt;%<span class="st">     </span><span class="co"># filter for the other trajectories</span>
<span class="st">      </span>dplyr::<span class="kw">select</span>(E,N) %&gt;%
<span class="st">      </span><span class="kw">as.matrix</span>()


<span class="co"># This is the original data.frame:</span>
<span class="kw">head</span>(pedestrians)
## # A tibble: 6 x 5
## # Groups:   TrajID [1]
##   TrajID        E        N DatetimeUTC         index
##    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dttm&gt;              &lt;int&gt;
## 1      1 2571414. 1205804. 2015-03-01 12:01:00     1
## 2      1 2571396. 1205791. 2015-03-01 12:02:00     2
## 3      1 2571373. 1205770. 2015-03-01 12:03:00     3
## 4      1 2571347. 1205753. 2015-03-01 12:04:00     4
## 5      1 2571336. 1205744. 2015-03-01 12:05:00     5
## 6      1 2571321. 1205732. 2015-03-01 12:06:00     6

<span class="co"># ..and this is the data converted to a matrix:</span>
<span class="kw">head</span>(traj1)
##            E       N
## [1,] 2571414 1205804
## [2,] 2571396 1205791
## [3,] 2571373 1205770
## [4,] 2571347 1205753
## [5,] 2571336 1205744
## [6,] 2571321 1205732</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-101"></span>
<img src="_main_files/figure-html/unnamed-chunk-101-1.png" alt="Comparing Trajectory 1 to trajectories 2 to 6" width="672" />
<p class="caption">
Figure 9: Comparing Trajectory 1 to trajectories 2 to 6
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
