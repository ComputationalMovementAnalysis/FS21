<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>GEO880: Patterns and Trends in Environmental Data</title>
  <meta name="description" content="GEO880: Patterns and Trends in Environmental Data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="GEO880: Patterns and Trends in Environmental Data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="GEO880: Patterns and Trends in Environmental Data" />
  
  
  

<meta name="author" content="Patrick Laube and Nils Ratnaweera">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exercise-2.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction Chapter</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#leaning-outcomes"><i class="fa fa-check"></i>Leaning outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#preperation"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#tasks-and-inputs"><i class="fa fa-check"></i>Tasks and inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-1-initialize-project"><i class="fa fa-check"></i>Task 1: Initialize project</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2-import-data"><i class="fa fa-check"></i>Task 2: Import data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3-explore-data"><i class="fa fa-check"></i>Task 3: Explore Data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-handling-spatial-data"><i class="fa fa-check"></i>Input: Handling spatial data</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4-project-data-from-wgs84"><i class="fa fa-check"></i>Task 4: Project data from WGS84</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#input-calculate-convex-hull"><i class="fa fa-check"></i>Input: Calculate Convex Hull</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5-ploting-spatial-objects"><i class="fa fa-check"></i>Task 5: Ploting spatial objects</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6-adding-a-background-map"><i class="fa fa-check"></i>Task 6: Adding a background map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#solutions-rcode"><i class="fa fa-check"></i>Solutions (RCode)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#preperation-1"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#demo-tidyverse"><i class="fa fa-check"></i>Demo Tidyverse</a><ul>
<li><a href="exercise-2.html#difftime"><code>difftime</code></a></li>
<li><a href="exercise-2.html#lead-lag"><code>lead()</code> / <code>lag()</code></a></li>
<li><a href="exercise-2.html#mutate"><code>mutate()</code></a></li>
<li><a href="exercise-2.html#group_by"><code>group_by()</code></a></li>
<li><a href="exercise-2.html#summarise"><code>summarise()</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#bring-it-all-together"><i class="fa fa-check"></i>Bring it all together…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#tasks-and-inputs-1"><i class="fa fa-check"></i>Tasks and Inputs</a><ul>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-1-getting-an-overview"><i class="fa fa-check"></i>Task 1: Getting an overview</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#input-geometry-as-columns"><i class="fa fa-check"></i>Input: Geometry as columns</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-2-deriving-movement-parameters-i-euclidean-distance-and-speed"><i class="fa fa-check"></i>Task 2: Deriving movement parameters I: Euclidean Distance and Speed</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-3-cross-scale-movement-analysis"><i class="fa fa-check"></i>Task 3: Cross-scale movement analysis</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-4-deriving-movement-parameters-ii-rolling-window-functions"><i class="fa fa-check"></i>Task 4: Deriving movement parameters II: Rolling window functions</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html#task-5-optional-calculate-turning-angles"><i class="fa fa-check"></i>Task 5 (optional): Calculate turning angles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i>Exercise 3</a><ul>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#learning-outcomes-1"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#preperation-2"><i class="fa fa-check"></i>Preperation</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#demo-tools-for-generic-segmentation"><i class="fa fa-check"></i>Demo: Tools for generic segmentation</a><ul>
<li><a href="exercise-3.html#introducing-cut-on-dummy-data">Introducing <code>cut()</code> on dummy data</a></li>
<li><a href="exercise-3.html#using-cut-on-timelag">Using <code>cut()</code> on <code>timelag</code></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#generating-unique-id-on-segments"><i class="fa fa-check"></i>Generating unique ID on segments</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#segmentation-as-in-laube-purves-2011"><i class="fa fa-check"></i>Segmentation as in Laube &amp; Purves (2011)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#tasks"><i class="fa fa-check"></i>Tasks</a><ul>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-1-segmentation"><i class="fa fa-check"></i>Task 1: Segmentation</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-2-explore-and-visualize-segementation"><i class="fa fa-check"></i>Task 2: Explore and visualize segementation</a></li>
<li><a href="exercise-3.html#task-3-optional-plotting-with-leaflet">Task 3 (Optional): Plotting with <code>leaflet</code></a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-4-similarity-measures"><i class="fa fa-check"></i>Task 4: Similarity measures</a></li>
<li class="chapter" data-level="" data-path="exercise-3.html"><a href="exercise-3.html#task-5-calculate-similarity"><i class="fa fa-check"></i>Task 5: Calculate similarity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO880: Patterns and Trends in Environmental Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-3" class="section level1">
<h1>Exercise 3</h1>
<!-- Stops and moves -->
<!-- Trajectory segmentation -->
<!-- Similarity measures and clustering -->
<div id="learning-outcomes-1" class="section level2">
<h2>Learning Outcomes</h2>
<ul>
<li>You are able to segment a trajectory using <span class="citation">Laube and Purves (2011)</span></li>
<li>You are able to compute the similarity between given trajectories using the package <code>SimilarityMeasures.</code></li>
<li>You acquire further useful data processing skills. <!-- Todo: passt das noch? --></li>
</ul>
</div>
<div id="prerequisites-2" class="section level2">
<h2>Prerequisites</h2>
<p>Readings Skills from “R for Data Science” <span class="citation">(Wickham and Grolemund 2017)</span>:</p>
<ul>
<li>RS3.1 Chap1 Data visualization with <code>ggplot2</code> (31, 3-35)</li>
<li>RS3.2 Chap5 Exploratory Data Analysis (28p, 81.109)</li>
</ul>
<p>Readings Theory:</p>
<p><span class="citation">Alan Both (2018)</span> A Comparative Analysis of Trajectory Similarity Measures: Recommendations for Selection and Use, in review with PLOS ONE, confidential. <!-- ToDO: get update on the package similarity measures --></p>
</div>
<div id="preperation-2" class="section level2">
<h2>Preperation</h2>
<p>Install the following libraries:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;scales&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;leaflet&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;SimilarityMeasures&quot;</span>)</code></pre></div>
<p>Open your R Project from last week. Either run your own script from last week or the following lines to bring the data to the form we need it for today exercise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(CMAtools)
<span class="kw">library</span>(sf)




<span class="co"># Import as tibble</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;../CMA_FS2018_Filestorage/wildschwein_BE.csv&quot;</span>,<span class="st">&quot;,&quot;</span>)

<span class="co"># Convert to sf-object</span>
wildschwein_BE =<span class="st"> </span><span class="kw">st_as_sf</span>(wildschwein_BE, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Long&quot;</span>, <span class="st">&quot;Lat&quot;</span>), <span class="dt">crs =</span> <span class="dv">4326</span>,<span class="dt">remove =</span> <span class="ot">FALSE</span>)

<span class="co"># transform to CH1903 LV95</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wildschwein_BE, <span class="dv">2056</span>)

<span class="co"># Add geometry as E/N integer Columns</span>
wildschwein_BE &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(wildschwein_BE) %&gt;%
<span class="st">  </span><span class="kw">cbind</span>(wildschwein_BE,.) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">E =</span> X) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">N =</span> Y)

<span class="co"># Compute timelag, steplength and speed</span>
wildschwein_BE &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">timelag =</span> <span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">lead</span>(DatetimeUTC),DatetimeUTC,<span class="dt">units =</span> <span class="st">&quot;secs&quot;</span>)),
    <span class="dt">steplength =</span> <span class="kw">euclid</span>(<span class="kw">lead</span>(E, <span class="dv">1</span>),<span class="kw">lead</span>(N, <span class="dv">1</span>),E,N),
    <span class="dt">speed =</span> steplength/timelag
  )</code></pre></div>
</div>
<div id="demo-tools-for-generic-segmentation" class="section level2">
<h2>Demo: Tools for generic segmentation</h2>
<!-- Todo laup: dieses demo ist noch etwas überfüllt. ich denke wir müssen hier noch ausdünnen. Vorschlag? -->
<div id="introducing-cut-on-dummy-data" class="section level3">
<h3>Introducing <code>cut()</code> on dummy data</h3>
<p>We often need to split a continuous variable into specific intervals. For this, the function <code>cut()</code>is very handy. We will introduce this function with a quick example. Assume we have a series of number that represent the ages of ten different people.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ages &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">18</span>,<span class="dv">13</span>,<span class="dv">53</span>,<span class="dv">50</span>,<span class="dv">23</span>,<span class="dv">43</span>,<span class="dv">68</span>,<span class="dv">40</span>)</code></pre></div>
<p>Let’s say we want to split this into equal intervals of 10 years.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">breaks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">10</span>)

<span class="kw">cut</span>(ages,<span class="dt">breaks =</span> breaks)
##  [1] (10,20] (20,30] (10,20] (10,20] &lt;NA&gt;    (40,50] (20,30] (40,50]
##  [9] &lt;NA&gt;    (30,40]
## Levels: (0,10] (10,20] (20,30] (30,40] (40,50]</code></pre></div>
<p>Note:</p>
<ul>
<li>If a number does not fit within an interval defined by <code>breaks =</code>, <code>cut()</code> will return <code>NA</code> (as for example for the fifth element <code>53</code>).</li>
<li>The default <code>labels</code> with <code>(</code> and <code>]</code> might seem a little ugly and puzzling at first, but in fact they are <a href="https://en.wikipedia.org/wiki/Interval_%28mathematics%29#Notations_for_intervals">a standard form of notating intervals in mathematics</a>.</li>
<li>If you don’t like <code>(</code> and <code>]</code>, you can:
<ul>
<li>specify your own labels with the argument <code>labels =</code> <em>or</em></li>
<li>use the the function <code>labels_nice</code> we provide with the <code>CMAtools</code>-package</li>
</ul></li>
<li>Four thresholds (i.e. <code>breaks</code>) return three intervals (i.e. <code>lables</code>), as shown below.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">library</span>(CMAtools)

breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">100</span>)

<span class="kw">cut</span>(ages, <span class="dt">breaks =</span> breaks, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;young&quot;</span>,<span class="st">&quot;middle aged&quot;</span>,<span class="st">&quot;old&quot;</span>))
##  [1] young       young       young       young       middle aged
##  [6] middle aged young       middle aged old         middle aged
## Levels: young middle aged old

<span class="kw">cut</span>(ages, <span class="dt">breaks =</span> breaks, <span class="dt">labels =</span> <span class="kw">labels_nice</span>(breaks))
##  [1] 0-30   0-30   0-30   0-30   30-60  30-60  0-30   30-60  60-100 30-60 
## Levels: 0-30 30-60 60-100</code></pre></div>
</div>
<div id="using-cut-on-timelag" class="section level3">
<h3>Using <code>cut()</code> on <code>timelag</code></h3>
<p>Last week you will have noticed that we have different sampling intervals within our wild boar data (this can be represented with the <code>timelag</code> column). We have to segment our trajectories in such a way, that we can perform further analysis during specific sampling intervals only. If we measure speed, or turning angles, we have to be very clear on what temporal (an thus spatial) scale or granularity we are performing this analysis.</p>
<p>We therefore have to define thresholds to group segments with a similar sampling interval. If we explore the dataset in more detail (e.g. using histograms at different scales), we can choose reasonable threshold values to group the trajectories into different sampling intervals.</p>
<!-- - It might make more sense to choose narrow intervals at shorter time lags and wider intervals at longer time lags. -->
<!-- - Store the interval names in a new column named `samplingInt` -->
<!-- - explore the dataset by using a logarithmic `y-axis` (`scale_y_log10()`) and looking at the different parts of the `x-axis` seperately -->
<!-- - We will later filter the data by the sampling interval. We therefore recommend the use of `labels_nice()` from the package `CMAtools` for nicer, more intuitive labels. -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">80</span>,<span class="dv">300</span>,<span class="dv">600</span>,<span class="dv">1200</span>,<span class="dv">2500</span>,<span class="dv">3000</span>,<span class="dv">4000</span>,<span class="dv">7500</span>,<span class="dv">110000</span>)


<span class="kw">ggplot</span>(wildschwein_BE, <span class="kw">aes</span>(timelag)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>) +
<span class="st">  </span><span class="kw">lims</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">600</span>)) +
<span class="st">  </span><span class="kw">scale_y_log10</span>() +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(wildschwein_BE, <span class="kw">aes</span>(timelag)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>) +
<span class="st">  </span><span class="kw">lims</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">600</span>,<span class="dv">1200</span>)) +
<span class="st">  </span><span class="kw">scale_y_log10</span>() +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="kw">ggplot</span>(wildschwein_BE, <span class="kw">aes</span>(timelag)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>) +
<span class="st">  </span><span class="kw">lims</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1200</span>,<span class="dv">10000</span>)) +
<span class="st">  </span><span class="kw">scale_y_log10</span>() +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

wildschwein_BE &lt;-<span class="st"> </span>wildschwein_BE %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(TierID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">samplingInt =</span> <span class="kw">cut</span>(timelag,<span class="dt">breaks =</span> breaks,<span class="dt">labels =</span> <span class="kw">labels_nice</span>(breaks))
  ) </code></pre></div>
</div>
<div id="generating-unique-id-on-segments" class="section level3">
<h3>Generating unique ID on segments</h3>
<p>Often it would be pretty handy if each sequence of positions with the <em>same</em> sampling interval had a unique ID. In this way, we could use this ID to filter the dataset for uninterrupted, “clean”, trajectories without varying sampling intervals and could also use the ID as a grouping variable.</p>
<p>This type of “grouping” similar values is a pretty common task that we often come across. So far, we’ve not found a good solution from available packages. We have therefore created our own function that we provide with the <code>CMAtools</code> package called <code>number_groups()</code>. This function takes a logical vector as an input and assigns subsequent <code>TRUE</code> values to the same group. Consider following example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample
##   position samplingInt
## 1     pos1          60
## 2     pos2          60
## 3     pos3          60
## 4     pos4         120
## 5     pos5         120
## 6     pos6         120</code></pre></div>
<p>In this example, the first three positions belong to one group and the next three belong to a second group. <code>number_groups()</code> takes a logical vector which answers the following question for each value <code>i</code>: “Does the next value (<code>i+1</code>) belong to the same group as <em>this</em> value <code>i</code>?”. We first have to provide the answer to this question by using <code>lead()</code> again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample &lt;-<span class="st"> </span>sample %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">samplingInt_control =</span> samplingInt ==<span class="st"> </span><span class="kw">lead</span>(samplingInt,<span class="dv">1</span>),
    <span class="dt">samplingInt_group =</span> <span class="kw">number_groups</span>(samplingInt_control,<span class="dt">include_first_false =</span> T)
  )

sample
##   position samplingInt samplingInt_control samplingInt_group
## 1     pos1          60                TRUE                 1
## 2     pos2          60                TRUE                 1
## 3     pos3          60               FALSE                 1
## 4     pos4         120                TRUE                 2
## 5     pos5         120                TRUE                 2
## 6     pos6         120                  NA                 2</code></pre></div>
<p>Use <code>?number_groups</code> to get more information.</p>
</div>
<div id="segmentation-as-in-laube-purves-2011" class="section level3">
<h3>Segmentation as in Laube &amp; Purves (2011)</h3>
<p>You’ve read <span class="citation">Laube and Purves (2011)</span> about segmenting trajectories. In the paper, they define “<em>static</em>” fixes as “<em>those whose average Euclidean distance to other fixes inside a temporal window v is less than some threshold d</em>”. This sounds more complicated than it is, the figure illustrates the method nicely.</p>
<div class="figure">
<img src="02_Images/laube_2011.jpg" alt="Laube and Purves (2011): (a) Temporal representation of constant sample interval with associated temporal window v for three exemplary points; (b) Measurement of average distance in temporal window v to sample points in spatial representation; (c) Removal of all points where average distance is less than a given threshold, i.e. removal of static points; and (d) Removal of subtrajectories with less than a threshold temporal length" />
<p class="caption"><span class="citation">Laube and Purves (2011)</span>: (a) Temporal representation of constant sample interval with associated temporal window v for three exemplary points; (b) Measurement of average distance in temporal window v to sample points in spatial representation; (c) Removal of all points where average distance is less than a given threshold, i.e. removal of static points; and (d) Removal of subtrajectories with less than a threshold temporal length</p>
</div>
<p>We will implement this method on some dummy data. Once you’ve grasped the idea on this simple data, you will implement it on the wild boar data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">10</span>)
X =<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">20</span>))
Y =<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">20</span>))

<span class="kw">plot</span>(X,Y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Assume the sampling interval is 5 minutes. If we take a temporal window of 20 minutes, that would mean we include 5 fixes into the calculation. We need to calculate the following Euclidean distances (pos representing a <code>X</code>,<code>Y</code>-position):</p>
<ol style="list-style-type: decimal">
<li>pos[n-2] to pos[n]</li>
<li>pos[n-1] to pos[n]</li>
<li>pos[n] to pos[n+1]</li>
<li>pos[n] to pos[n+2]</li>
</ol>
<p>You can use the function <code>euclid()</code> to calculate the distances and <code>dplyr</code> functions <code>lead()</code>/<code>lag()</code> to create the necessary offsets. On our dummy data, we want to calculate the mean of the following distances (red, dotted lines).</p>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
nMinus2 &lt;-<span class="st"> </span><span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">2</span>),<span class="kw">lag</span>(Y, <span class="dv">2</span>),X,Y)   <span class="co"># distance to pos. -10 minutes</span>
nMinus1 &lt;-<span class="st"> </span><span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">1</span>),<span class="kw">lag</span>(Y, <span class="dv">1</span>),X,Y)   <span class="co"># distance to pos.  -5 minutes</span>
nPlus1  &lt;-<span class="st"> </span><span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">1</span>),<span class="kw">lead</span>(Y, <span class="dv">1</span>)) <span class="co"># distance to pos   +5 mintues</span>
nPlus2  &lt;-<span class="st"> </span><span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">2</span>),<span class="kw">lead</span>(Y, <span class="dv">2</span>)) <span class="co"># distance to pos  +10 minutes</span>

<span class="co"># Use cbind to bind all rows to a matrix</span>
distances &lt;-<span class="st"> </span><span class="kw">cbind</span>(nMinus2,nMinus1,nPlus1,nPlus2)
distances
##        nMinus2   nMinus1    nPlus1   nPlus2
##  [1,]       NA        NA 2.1930407 3.255812
##  [2,]       NA 2.1930407 1.5283951 3.418902
##  [3,] 3.255812 1.5283951 2.2021404 3.397941
##  [4,] 3.418902 2.2021404 1.2990315 1.776001
##  [5,] 3.397941 1.2990315 0.5399653 1.340062
##  [6,] 1.776001 0.5399653 1.3900290 2.214298
##  [7,] 1.340062 1.3900290 0.9449451 2.215854
##  [8,] 2.214298 0.9449451 1.6298525 1.916421
##  [9,] 2.215854 1.6298525 0.3608126 2.270722
## [10,] 1.916421 0.3608126 2.1564489 2.679915
## [11,] 2.270722 2.1564489 0.7597903 1.030078
## [12,] 2.679915 0.7597903 0.9974347 1.375450
## [13,] 1.030078 0.9974347 1.0046117 2.101651
## [14,] 1.375450 1.0046117 1.5664940 2.935460
## [15,] 2.101651 1.5664940 1.4382922 1.378950
## [16,] 2.935460 1.4382922 1.0212859 1.809509
## [17,] 1.378950 1.0212859 1.7698785 2.207931
## [18,] 1.809509 1.7698785 0.9807744 1.713668
## [19,] 2.207931 0.9807744 0.8110503       NA
## [20,] 1.713668 0.8110503        NA       NA

<span class="co"># This just gives us the overall mean</span>
<span class="kw">mean</span>(distances, <span class="dt">na.rm =</span> T)
## [1] 1.719808

<span class="co"># We therefore need the function `rowMeans()`</span>
rowmeans &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(distances)
<span class="kw">cbind</span>(distances,rowmeans)
##        nMinus2   nMinus1    nPlus1   nPlus2 rowmeans
##  [1,]       NA        NA 2.1930407 3.255812       NA
##  [2,]       NA 2.1930407 1.5283951 3.418902       NA
##  [3,] 3.255812 1.5283951 2.2021404 3.397941 2.596072
##  [4,] 3.418902 2.2021404 1.2990315 1.776001 2.174019
##  [5,] 3.397941 1.2990315 0.5399653 1.340062 1.644250
##  [6,] 1.776001 0.5399653 1.3900290 2.214298 1.480073
##  [7,] 1.340062 1.3900290 0.9449451 2.215854 1.472723
##  [8,] 2.214298 0.9449451 1.6298525 1.916421 1.676379
##  [9,] 2.215854 1.6298525 0.3608126 2.270722 1.619310
## [10,] 1.916421 0.3608126 2.1564489 2.679915 1.778399
## [11,] 2.270722 2.1564489 0.7597903 1.030078 1.554260
## [12,] 2.679915 0.7597903 0.9974347 1.375450 1.453147
## [13,] 1.030078 0.9974347 1.0046117 2.101651 1.283444
## [14,] 1.375450 1.0046117 1.5664940 2.935460 1.720504
## [15,] 2.101651 1.5664940 1.4382922 1.378950 1.621347
## [16,] 2.935460 1.4382922 1.0212859 1.809509 1.801137
## [17,] 1.378950 1.0212859 1.7698785 2.207931 1.594511
## [18,] 1.809509 1.7698785 0.9807744 1.713668 1.568457
## [19,] 2.207931 0.9807744 0.8110503       NA       NA
## [20,] 1.713668 0.8110503        NA       NA       NA

<span class="co"># and if we put it all together:</span>
<span class="kw">rowMeans</span>(
  <span class="kw">cbind</span>(
    <span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">2</span>),<span class="kw">lag</span>(Y, <span class="dv">2</span>),X,Y),
    <span class="kw">euclid</span>(<span class="kw">lag</span>(X, <span class="dv">1</span>),<span class="kw">lag</span>(Y, <span class="dv">1</span>),X,Y),  
    <span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">1</span>),<span class="kw">lead</span>(Y, <span class="dv">1</span>)), 
    <span class="kw">euclid</span>(X,Y,<span class="kw">lead</span>(X, <span class="dv">2</span>),<span class="kw">lead</span>(Y, <span class="dv">2</span>))
  )
)
##  [1]       NA       NA 2.596072 2.174019 1.644250 1.480073 1.472723
##  [8] 1.676379 1.619310 1.778399 1.554260 1.453147 1.283444 1.720504
## [15] 1.621347 1.801137 1.594511 1.568457       NA       NA</code></pre></div>
</div>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<div id="task-1-segmentation" class="section level3">
<h3>Task 1: Segmentation</h3>
<p>Picking up from the previous input: we can now implement this algorithm using the <code>dplyr</code> / <code>mutate()</code> method. This might seem a little challenging at first, but if you have completed Task 2 from last week, it is quite easy. You can pass <em>anything</em> to a new column within <code>mutate()</code> as long as it is a vector of the same length as the original dataframe.</p>
</div>
<div id="task-2-explore-and-visualize-segementation" class="section level3">
<h3>Task 2: Explore and visualize segementation</h3>
<p>After calculating <code>stepMean</code>, you can explore the newly created Values <code>stepMean</code> using summary statistics (histograms, boxplot, <code>summary()</code>) and define a reasonable threshold value to differentiate between “stops” and “moves”. There is no “correct” way of doing this, specifying a threshold always depends on the question that needs to be answered.</p>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA&#39;s 
##    0.000    5.109   14.211   57.382   62.224 1811.620       40</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Based on this data, I will go with a threshold value of 15. Apply your threshold on you data, then plot a <em>subset</em> of data to verify if the arbitrary threshold was a reasonable choice.</p>
<ul>
<li>You can apply the threshold with an <code>ifelse()</code>statement with the condition (<code>stepMean &gt; 15</code>), and two keywords when this condition is met (e.g. “move”) and when it’s not (e.g. “stop”).</li>
<li>sub-setting the first ten rows can be done with <code>[1:10,]</code> (don’t forget the comma!)</li>
<li>we have a couple of NA values in the beginning and end of each trajectory. Use <code>filter(!is.na(movement))</code> to remove these values from the plot</li>
<li>like last week, add the trajectory using <code>geom_path()</code> and <code>geom_point</code></li>
<li>add <code>coord_equal()</code></li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
<div id="task-3-optional-plotting-with-leaflet" class="section level3">
<h3>Task 3 (Optional): Plotting with <code>leaflet</code></h3>
<p>To be honest, exploring segmentation with <code>ggplot</code> is not very satisfying when exploring the data. Another great tool to visualize spatial data is leaflet. It’s not all that hard to create a leaflet plot, just take a look at <a href="https://rstudio.github.io/leaflet/">the documentation</a> and try it with our segmented wild boar data. Note: You can only pass the <code>Lat</code>/<code>Long</code> coordinates to leaflet, it cannot handle our <code>E</code>/<code>N</code>-data. This is one of the reasons we’ve held on to this column in the first place.</p>
<div id="htmlwidget-580f5e68eae3fb7ab16c" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-580f5e68eae3fb7ab16c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addCircles","args":[[46.9937867,46.9938264,46.9937648,46.9938452,46.9938116,46.9957989,46.9957965,46.9958249,46.9959277,46.9963393,46.9964437,46.9965222,46.9963218,46.9963578,46.9965654,46.9964389,46.996499,46.9964744,46.9965099,46.9965474,46.9963882,46.996418,46.9966339,46.9963478,46.9962772,46.9963862,46.9964351,46.996442,46.9964163,46.9964286,46.9964199,46.9965486,46.9957771,46.9957743,46.9957252,46.995675,46.9956896,46.9957823,46.9959253,46.9957251,46.9958311,46.9955844,46.9957705,46.9940622,46.9939954,46.9939963,46.9939701,46.9939512,46.9939736,46.9939789,46.9939988,46.9940287,46.9938164,46.9939046,46.9939527,46.9939814,46.9940294,46.9939713,46.9939362,46.9940107,46.9940139,46.9940024,46.9938879,46.9939225,46.9939975,46.9940269,46.9940517,46.9939216,46.9939374,46.9940085,46.9942688,46.9921269,46.9913476,46.992975,46.9930631,46.993008,46.993053,46.9928841,46.9928612,46.9928469,46.9928422,46.9929024,46.995038,46.9976246,46.9950694,46.9964063,46.9964288,46.9964068,46.9964117,46.9963901,46.996443,46.996401,46.9964206,46.9964329,46.9964223,46.9964178,46.9964047,46.9964194,46.9964178,46.9964163,46.9964401,46.9963858,46.9963951,46.996419,46.9964198,46.9964228,46.9964141,46.9964402,46.9964083,46.9964321,46.9964166,46.996458,46.9964349,46.996319,46.9964471,46.9964394,46.996432,46.9964167,46.9964194,46.9964198,46.9963846,46.9963888,46.9959004,46.9974221,46.9955157,46.9924171,46.9923371,46.9929309,46.9929698,46.9929883,46.9929029,46.9928806,46.9922637,46.9922455,46.992187,46.9915094,46.9914898,46.9914642,46.9917124,46.991487,46.9915528,46.9914931,46.991503,46.9914862,46.9915944,46.9913494,46.991346,46.9914544,46.9915386,46.9914502,46.9914874,46.9915022,46.9914882,46.9914969,46.9915952,46.9915177,46.9915581,46.9914532,46.9915508,46.9915115,46.9915814,46.991504,46.991505,46.9915838,46.9914865,46.992193,46.9924326,46.9930445,46.9930563,46.9928221,46.9920751,46.9907789,46.9917531,46.9918309,46.9918692,46.9920833,46.9922865,46.9922832,46.9923085,46.9920421,46.9928408,46.992744,46.9929385,46.9923112,46.9921324,46.9915002,46.9915289,46.9915016,46.9914625,46.9914817,46.9914496,46.9915353,46.9915453,46.9914678,46.9914724,46.9914593,46.9914471,46.9913711],[7.0493667,7.0493292,7.0493359,7.049282,7.0494009,7.0519123,7.0517966,7.051658,7.0515876,7.0518024,7.0515023,7.051856,7.051708,7.0517048,7.0519878,7.0517354,7.0517957,7.0517957,7.0518885,7.0517857,7.0517127,7.0516849,7.0503409,7.0503073,7.0502944,7.0501101,7.0502891,7.0503086,7.0502875,7.0502712,7.0502695,7.0503509,7.0532236,7.0532135,7.0532611,7.0531761,7.0532334,7.0531795,7.0529105,7.0531877,7.0530814,7.0530495,7.0532382,7.0537408,7.0536857,7.0537135,7.0538035,7.0536808,7.0536807,7.0536775,7.0536418,7.0536073,7.0537531,7.0537477,7.0539711,7.0539154,7.053984,7.0538993,7.0538081,7.053901,7.0538651,7.0536088,7.0538426,7.0537365,7.0536858,7.0537774,7.0540327,7.0539845,7.0538292,7.0539009,7.0538876,7.0537289,7.0470418,7.0450306,7.0448446,7.0448855,7.0448773,7.045409,7.0453666,7.0454073,7.0454043,7.0453518,7.0434686,7.0413481,7.0433822,7.0424996,7.0424181,7.0424361,7.0424638,7.0424835,7.0423936,7.042454,7.0424426,7.0424588,7.0424899,7.0424638,7.0424769,7.042454,7.0424638,7.0425471,7.0423414,7.0424343,7.0424472,7.0424687,7.0424393,7.0424753,7.0424409,7.0424474,7.0424426,7.0424231,7.0424753,7.0424688,7.0424181,7.0422244,7.0424343,7.0424442,7.0423496,7.0423939,7.0424215,7.0424231,7.0424132,7.0424377,7.045315,7.0476966,7.0515736,7.0548682,7.0510693,7.0504652,7.0502533,7.0503431,7.0504507,7.0501833,7.0501187,7.0501271,7.050057,7.0489609,7.0489736,7.0489934,7.0488943,7.0489786,7.0488987,7.0489786,7.0488629,7.0489591,7.0490077,7.0488534,7.048896,7.0489054,7.0489966,7.0489786,7.0489802,7.0490145,7.0489346,7.0490014,7.0490586,7.0489786,7.0489605,7.0489819,7.0489394,7.0489948,7.0489882,7.0489816,7.0489607,7.0489491,7.0488872,7.0498613,7.05019,7.0501359,7.0502482,7.0504542,7.0525551,7.0529089,7.0557707,7.0560722,7.0560787,7.0561338,7.0558287,7.0557749,7.0556721,7.053985,7.0505522,7.0504118,7.0502434,7.0501448,7.0497098,7.0490064,7.048967,7.0488973,7.0489135,7.0489655,7.0489837,7.0489591,7.0489168,7.0489428,7.0489363,7.0489494,7.0489331,7.0489548],1,null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":["#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#00BFC4","#F8766D","#00BFC4","#F8766D","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#00BFC4","#F8766D","#00BFC4","#F8766D","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#F8766D","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4","#00BFC4"],"fillOpacity":0.2,"dashArray":null},null,null,null,null,null,null]},{"method":"addPolylines","args":[[[[{"lng":[7.0493667,7.0493292,7.0493359,7.049282,7.0494009,7.0519123,7.0517966,7.051658,7.0515876,7.0518024,7.0515023,7.051856,7.051708,7.0517048,7.0519878,7.0517354,7.0517957,7.0517957,7.0518885,7.0517857,7.0517127,7.0516849,7.0503409,7.0503073,7.0502944,7.0501101,7.0502891,7.0503086,7.0502875,7.0502712,7.0502695,7.0503509,7.0532236,7.0532135,7.0532611,7.0531761,7.0532334,7.0531795,7.0529105,7.0531877,7.0530814,7.0530495,7.0532382,7.0537408,7.0536857,7.0537135,7.0538035,7.0536808,7.0536807,7.0536775,7.0536418,7.0536073,7.0537531,7.0537477,7.0539711,7.0539154,7.053984,7.0538993,7.0538081,7.053901,7.0538651,7.0536088,7.0538426,7.0537365,7.0536858,7.0537774,7.0540327,7.0539845,7.0538292,7.0539009,7.0538876,7.0537289,7.0470418,7.0450306,7.0448446,7.0448855,7.0448773,7.045409,7.0453666,7.0454073,7.0454043,7.0453518,7.0434686,7.0413481,7.0433822,7.0424996,7.0424181,7.0424361,7.0424638,7.0424835,7.0423936,7.042454,7.0424426,7.0424588,7.0424899,7.0424638,7.0424769,7.042454,7.0424638,7.0425471,7.0423414,7.0424343,7.0424472,7.0424687,7.0424393,7.0424753,7.0424409,7.0424474,7.0424426,7.0424231,7.0424753,7.0424688,7.0424181,7.0422244,7.0424343,7.0424442,7.0423496,7.0423939,7.0424215,7.0424231,7.0424132,7.0424377,7.045315,7.0476966,7.0515736,7.0548682,7.0510693,7.0504652,7.0502533,7.0503431,7.0504507,7.0501833,7.0501187,7.0501271,7.050057,7.0489609,7.0489736,7.0489934,7.0488943,7.0489786,7.0488987,7.0489786,7.0488629,7.0489591,7.0490077,7.0488534,7.048896,7.0489054,7.0489966,7.0489786,7.0489802,7.0490145,7.0489346,7.0490014,7.0490586,7.0489786,7.0489605,7.0489819,7.0489394,7.0489948,7.0489882,7.0489816,7.0489607,7.0489491,7.0488872,7.0498613,7.05019,7.0501359,7.0502482,7.0504542,7.0525551,7.0529089,7.0557707,7.0560722,7.0560787,7.0561338,7.0558287,7.0557749,7.0556721,7.053985,7.0505522,7.0504118,7.0502434,7.0501448,7.0497098,7.0490064,7.048967,7.0488973,7.0489135,7.0489655,7.0489837,7.0489591,7.0489168,7.0489428,7.0489363,7.0489494,7.0489331,7.0489548],"lat":[46.9937867,46.9938264,46.9937648,46.9938452,46.9938116,46.9957989,46.9957965,46.9958249,46.9959277,46.9963393,46.9964437,46.9965222,46.9963218,46.9963578,46.9965654,46.9964389,46.996499,46.9964744,46.9965099,46.9965474,46.9963882,46.996418,46.9966339,46.9963478,46.9962772,46.9963862,46.9964351,46.996442,46.9964163,46.9964286,46.9964199,46.9965486,46.9957771,46.9957743,46.9957252,46.995675,46.9956896,46.9957823,46.9959253,46.9957251,46.9958311,46.9955844,46.9957705,46.9940622,46.9939954,46.9939963,46.9939701,46.9939512,46.9939736,46.9939789,46.9939988,46.9940287,46.9938164,46.9939046,46.9939527,46.9939814,46.9940294,46.9939713,46.9939362,46.9940107,46.9940139,46.9940024,46.9938879,46.9939225,46.9939975,46.9940269,46.9940517,46.9939216,46.9939374,46.9940085,46.9942688,46.9921269,46.9913476,46.992975,46.9930631,46.993008,46.993053,46.9928841,46.9928612,46.9928469,46.9928422,46.9929024,46.995038,46.9976246,46.9950694,46.9964063,46.9964288,46.9964068,46.9964117,46.9963901,46.996443,46.996401,46.9964206,46.9964329,46.9964223,46.9964178,46.9964047,46.9964194,46.9964178,46.9964163,46.9964401,46.9963858,46.9963951,46.996419,46.9964198,46.9964228,46.9964141,46.9964402,46.9964083,46.9964321,46.9964166,46.996458,46.9964349,46.996319,46.9964471,46.9964394,46.996432,46.9964167,46.9964194,46.9964198,46.9963846,46.9963888,46.9959004,46.9974221,46.9955157,46.9924171,46.9923371,46.9929309,46.9929698,46.9929883,46.9929029,46.9928806,46.9922637,46.9922455,46.992187,46.9915094,46.9914898,46.9914642,46.9917124,46.991487,46.9915528,46.9914931,46.991503,46.9914862,46.9915944,46.9913494,46.991346,46.9914544,46.9915386,46.9914502,46.9914874,46.9915022,46.9914882,46.9914969,46.9915952,46.9915177,46.9915581,46.9914532,46.9915508,46.9915115,46.9915814,46.991504,46.991505,46.9915838,46.9914865,46.992193,46.9924326,46.9930445,46.9930563,46.9928221,46.9920751,46.9907789,46.9917531,46.9918309,46.9918692,46.9920833,46.9922865,46.9922832,46.9923085,46.9920421,46.9928408,46.992744,46.9929385,46.9923112,46.9921324,46.9915002,46.9915289,46.9915016,46.9914625,46.9914817,46.9914496,46.9915353,46.9915453,46.9914678,46.9914724,46.9914593,46.9914471,46.9913711]}]]],null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.1,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false},null,null,null,null,null]},{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addLegend","args":[{"colors":["#F8766D","#00BFC4"],"labels":["move","stop"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"factor","title":"Animal moving?","extra":null,"layerId":null,"className":"info legend"}]}],"limits":{"lat":[46.9907789,46.9976246],"lng":[7.0413481,7.0561338]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="task-4-similarity-measures" class="section level3">
<h3>Task 4: Similarity measures</h3>
<p>Import the dataset <code>pedestrian.csv</code> (available on moodle). It it a set of six similar, but varying trajectories from pedestrians walking on a path. We will analyse these trajectories with the package <code>SimilarityMeasures</code>, comparing trajectory 1 to the trajectories 2-6. In this task, explore these trajectories first and understand how the pedestrians moved.</p>
<!-- Todo Nils: Traj 5 should acutally be exactly like traj 6, except for the outlier. In this way, the effect of the outlier is clearly visible. -->
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-81-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-81-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-81-4.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-81-5.png" width="672" /></p>
</div>
<div id="task-5-calculate-similarity" class="section level3">
<h3>Task 5: Calculate similarity</h3>
<p>Calculate the similarity between trajectory 1 and trajectories 2-6. Visualize your results. Note: All functions in the package needs matrices as input, with one trajectory per matrix. Therefore, split the dataframe into 6 matrices with just two columns each, <code>E</code> and <code>N</code>. You can do this with the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

traj1 &lt;-<span class="st"> </span>pedestrians %&gt;%
<span class="st">      </span><span class="kw">filter</span>(TrajID ==<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="co"># Change value 1 to 2,3 etc to  </span>
<span class="st">      </span><span class="kw">as.data.frame</span>() %&gt;%<span class="st">     </span><span class="co"># filter for the other trajectories</span>
<span class="st">      </span>dplyr::<span class="kw">select</span>(E,N) %&gt;%
<span class="st">      </span><span class="kw">as.matrix</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<!-- ## Solution (R Code) -->
<!-- ```{r code=readLines('13_Week3/RFiles/W03_01_Exercise.R'), results='asis', echo = T, include=T, eval=F} -->
<!-- ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
