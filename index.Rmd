---
title: "Patterns and Trends in Environmental Data"
subtitle: "Master ENR, Spring Semester 2021"
author: "Patrick Laube, Nils Ratnaweera, Nikolaos Bakogiannis"
date: "`r format(Sys.time(), '%d %B, %Y')`"
site: bookdown::bookdown_site
documentclass: book
bibliography: ["00_Admin/bibliography.bib"]
link-citations: true
geometry: "left=2cm, right=2cm, top=2.5cm, bottom=2cm"
---
```{r include=FALSE}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(include = F)
knitr::opts_chunk$set(eval = T)

knitr::opts_chunk$set(purl = T)

knitr::opts_chunk$set(collapse = T)
knitr::opts_chunk$set(warning = F)
knitr::opts_chunk$set(message = F)


# include = FALSE prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.

# echo = FALSE prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.

# message = FALSE prevents messages that are generated by code from appearing in the finished file.

# warning = FALSE prevents warnings that are generated by code from appearing in the finished.

# fig.cap = "..." adds a caption to graphical results.

# See the R Markdown Reference Guide for a complete list of knitr chunk options.
# https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf
```

```{r}
# Allow duplicate Labels so that calling purl() does not create an error
# https://stackoverflow.com/q/36868287/4139249
# options(knitr.duplicate.label = 'allow')

# purl all Rmd Documents (with some exceptions) and store them in a Subfolder /RFiles
# Document cannot be knitted if the folder "RFiles" does not exist!

options(knitr.duplicate.label = 'allow')

library(stringr)

rmds <- list.files(pattern = "\\.Rmd",recursive = T)

exclude <- c("_Rcode","99_","index","Archive","Admin","_main","project_ideas","RFiles","patterns-and-trends")

rmds <- rmds[-grep(paste(exclude,collapse="|"),ignore.case = TRUE, rmds, value=F)]

for (file in rmds){
  file_r <- paste0(str_split_fixed(file,"\\.",2)[1],"_code.R",collapse = "")
  file_r <- str_split_fixed(file_r,"/",Inf)   # split path at /
  file_r <- append(file_r, "RFiles",length(file_r)-1)# append Foldername
  file_r <- paste(file_r,collapse = "/")    # collapse vector to string
  if(file.exists(file_r)){
    file.remove(file_r)
  }
  knitr::purl(file,documentation = 0,output = file_r)


}
 
```

```{r, echo = FALSE}
mydecrypt <- function(input, output = NULL, passphrase = NULL, verbosity = 1, overwrite = TRUE){
  require(stringr)
  require(rcrypt)
  
  if(is.null(passphrase)){
    passphrase <- readLines(".passphrase",warn = FALSE)
  }
  
    if(is.null(output)){
    output <- str_remove(input, ".gpg|.asc")
  }
  
  if(overwrite & file.exists(output)){
    file.remove(output)
    warning("Removed file",output)
  }
  
  decrypt(input = input,output = output, passphrase = passphrase, verbosity = verbosity)
  
  mylines <- readLines(output,warn = FALSE)
  file.remove(output)
  
  mylines
}
```


# Introduction Chapter {-}

For our practical `R` course building-up skills for analyzing movement data in the software environment `R`, you'll be using data from the ZHAW project ["Prävention von Wildschweinschäden in der Landwirtschaft"](https://www.zhaw.ch/de/ueber-uns/aktuell/news/detailansicht-news/event-news/wildschweinschaeden-mit-akustischer-methode-verhindern/). Watch [this video on youtube](https://youtu.be/WYXnCQMfPiI) for a nice introduction into the project.


The project investigates the spatiotemporal movement patterns of wild boar (*Sus scrofa*) in agricultural landscapes. We will study the trajectories of these wild boar, practicing the most basic analysis tasks of Computational Movement Analysis (CMA). 

**Please note:** we are given application data from an ongoing research project. Capturing wild living animals and then equipping them with GPS collars is a very labor and cost intensive form of research. Consequently, data resulting such campaigns is a very valuable asset that must be protected. So, please do not pass on this data, for any use beyond this module contact Patrick Laube or the data owner Stefan Suter (suts@zhaw.ch).



